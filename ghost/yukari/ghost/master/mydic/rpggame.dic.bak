///////////////////////////////////////////
////////// RPG文字
////////// modified by Cster 2015
///////////////////////////////////////////
OnRpgGame
{


	if reference0 != "" {
		OpenRpgGameMenu(reference0);
	}
	else {
		OpenRpgGameMenu;
	}
}



OpenRpgGameMenu
{
	_submenu = 0;
	if _argc > 0 {
		_submenu = _argv[0];
	}
			
	--
	_sub = "◆,◇,◇,◇,◇,◇,◆,◇,◇,◇,◇,◇,◆,◇,◇,◇,◇,◇,◆,◇,◇,◇,◇,◇,◆,◇,◇,◇,◇,◇,◆";

	"\![set,choicetimeout,0]\b[2]\_q\q[%(_sub[_submenu])状态,OnSubRpgGameMenu,0]/
	\_l[50]\q[%(_sub[_submenu + 5])装备,OnSubRpgGameMenu,1]/
	\_l[100]\q[%(_sub[_submenu + 10])魔法,OnSubRpgGameMenu,2]/
	\_l[150]\q[%(_sub[_submenu + 15])道具,OnSubRpgGameMenu,3]/
        \_l[200]\q[%(_sub[_submenu + 20])商店,OnSubRpgGameMenu,4]/
        \_l[250]\q[%(_sub[_submenu + 25])任务,OnSubRpgGameMenu,5]"
	--
	SubRpgGameMenu(_submenu);
       
}

OnSubRpgGameMenu
{
	OpenRpgGameMenu(reference0);
}

SubRpgGameMenu
{

	_submenu = _argv[0];       
        信息参数
	case _submenu {
		when 0 { 
			状态
		}
		when 1 {
			装备

		}
		when 2 {魔法
			
		}
                when 3 {道具
	         
 
		}


		when 4 {kikkashopMenu
			
		}
 
               when 5 {mission
			
		}


	}
}




RpgGameVar
{
if gamestart==NULL
{
rpggamereset
gamestart=1
}

if towashell == NULL
{
towashell=0
}

mlv =TOINT((lvl0 + lvl1 )/2 + mlvx)
lvl =TOINT((lvl0 + lvl1 )/2)
expmax0 = 10 * (lvl0 + 1)*(lvl0 + 1)
expmax1 = 10 * (lvl1 + 1)*(lvl1 + 1)
A0 = (lvl0 + 8)*(lvl0 + 9)
A1 = (lvl1 + 8)*(lvl1 + 9)
A2 = (mlv + 8)*(mlv + 9)
B0 = (lvl0 + 16)*(lvl0 + 17)
B1 = (lvl1 + 16)*(lvl1 + 17)
B2 = (mlv + 16)*(mlv + 17)

hpmax0 = TOINT(1.05*A0)

epmax0 = TOINT(40 + 10*lvl0)
epmax1 = TOINT(40 + 10*lvl1)
cpmax = 200

str0 = TOINT(STRADD*(0.05*B0 + 20 + weaponequip_str0 + armorequip_str0))
str0_=TOINT(0.05*B0 + 20) + "+" + TOINT(weaponequip_str0 + armorequip_str0)

def0 = TOINT(DEFADD*(0.8*0.05*B0 + armorequip_def0 + bootsequip_def0))
def0_ = TOINT(0.8*0.05*B0) + "+" + TOINT(armorequip_def0 + bootsequip_def0)

ats0 = TOINT(0.05*B0 + weaponequip_ats0 + armorequip_ats0 + bootsequip_ats0)
ats0_=TOINT(0.05*B0) + "+" + TOINT(weaponequip_ats0 + armorequip_ats0 + bootsequip_ats0)

adf0 = TOINT(15 + armorequip_adf0 + bootsequip_adf0)
adf0_ =15 + "+" + TOINT(armorequip_adf0 + bootsequip_adf0)
adf1 = TOINT(15 + armorequip_adf1 + bootsequip_adf1)
adf1_ =15 + "+" + TOINT(armorequip_adf1 + bootsequip_adf1)

if towashell ==0
{
hpmax1 = TOINT(1.05*A1)
str1 = TOINT(STRADD*(0.9*0.05*B1 + 20 + weaponequip_str1 + armorequip_str1))
str1_=TOINT(0.9*0.05*B1 + 20) + "+" + TOINT(weaponequip_str1 + armorequip_str1)

def1 = TOINT(DEFADD*(0.78*0.05*B1 + armorequip_def1 + bootsequip_def1))
def1_ = TOINT(0.78*0.05*B1) + "+" + TOINT(armorequip_def1 + bootsequip_def1)

ats1 =TOINT(1.2*0.05*B1 + weaponequip_ats1 + armorequip_ats1 + bootsequip_ats1)
ats1_=TOINT(1.2*0.05*B1) + "+" + TOINT(weaponequip_ats1 + armorequip_ats1 + bootsequip_ats1)
}

elseif  towashell ==1
{
hpmax1 = TOINT(0.95*A1)
str1 = TOINT(STRADD*(1.2*0.05*B1 + 20 + weaponequip_str1 + armorequip_str1))
str1_=TOINT(1.2*0.05*B1 + 20) + "+" + TOINT(weaponequip_str1 + armorequip_str1)

def1 = TOINT(DEFADD*(0.9*0.05*B1 + armorequip_def1 + bootsequip_def1))
def1_ = TOINT(0.9*0.05*B1) + "+" + TOINT(armorequip_def1 + bootsequip_def1)


ats1 =TOINT(0.05*B1 + weaponequip_ats1 + armorequip_ats1 + bootsequip_ats1)
ats1_=TOINT(0.05*B1) + "+" + TOINT(weaponequip_ats1 + armorequip_ats1 + bootsequip_ats1)
}


elseif  towashell ==2
{
hpmax1 = TOINT(A1)
str1 = TOINT(STRADD*(0.05*B1 + 20 + weaponequip_str1 + armorequip_str1))
str1_=TOINT(0.05*B1 + 20) + "+" + TOINT(weaponequip_str1 + armorequip_str1)

def1 = TOINT(DEFADD*(0.8*0.05*B1 + armorequip_def1 + bootsequip_def1))
def1_ = TOINT(0.8*0.05*B1) + "+" + TOINT(armorequip_def1 + bootsequip_def1)

ats1 =TOINT(0.05*B1 + weaponequip_ats1 + armorequip_ats1 + bootsequip_ats1)
ats1_=TOINT(0.05*B1) + "+" + TOINT(weaponequip_ats1 + armorequip_ats1 + bootsequip_ats1)
}

mhpmaxD = TOINT(A2)
mhpmaxC = TOINT(1.5*A2)
mhpmaxB = TOINT(2*A2)
mhpmaxA = TOINT(2.5*A2)
mstrD = TOINT((0.86+level*0.1)*0.05*B2 + 20)
mstrC = TOINT((1.16+level*0.1)*0.05*B2 + 20)
mstrB = TOINT((1.46+level*0.1)*0.05*B2 + 20)
mstrA = TOINT((1.76+level*0.1)*0.05*B2 + 20)
mdefD = TOINT(IGN*DEFMINUS*(0.2+level*0.1)*0.05*B2)
mdefC = TOINT(IGN*DEFMINUS*(0.3+level*0.1)*0.05*B2)
mdefB = TOINT(IGN*DEFMINUS*(0.4+level*0.1)*0.05*B2)
mdefA = TOINT(IGN*DEFMINUS*(0.5+level*0.1)*0.05*B2)


matsD = TOINT(10+level*5+mlv*0.5)
matsC = TOINT(20+level*5+mlv*0.5)
matsB = TOINT(30+level*5+mlv*0.5)
matsA = TOINT(40+level*5+mlv*0.5)
madfD = TOINT(50*怪物魔防+level*20-20)
madfC = TOINT(50*怪物魔防+level*20-20)
madfB = TOINT(50*怪物魔防+level*20-20)
madfA = TOINT(50*怪物魔防+level*20-20)
nextexp0 = expmax0 - exp0
nextexp1 = expmax1 - exp1


}

rpggamereset
{
RpgGameVar
exp0=0
exptotal0=0
exp1=0
exptotal1=0
lvl0=1
lvl1=1
hp0=hpmax0
hp1=hpmax1
ep0=epmax0
ep1=epmax1
cp0=0
cp1=0
ANG=1
ADD=1
money=500
weaponAnum=(2,0,0,0,0,0,0,0,0,0)
weaponBnum=(0,0,0,0,0,0,0,0,0,0)
armorAnum=(2,0,0,0,0,0)
armorBnum=(0,0,0,0,0,0)
bootsAnum=(2,0,0,0,0,0)
bootsBnum=(0,0,0,0,0,0)

itemAnum=(2,0,0,0,0)
itemBnum=(2,0,0,0,0)

}


状态
{
IGN=1
ANG=1
STRADD=1
DEFADD=1
DEFMINUS=1
if hp0==0
     {
      hp0=TOINT(0.1*hpmax0)
     }

   if hp1==0
     {
     hp1=TOINT(0.1*hpmax1)
     }
RpgGameVar
	_txt = "\_l[0,20]小缘\n/
         \f[color,231,171,109]Level   \_l[48,-]\f[color,default]%(lvl0)\n/
         \f[color,231,171,109]HP      \_l[48,-]\f[color,default]%(hp0)/%(hpmax0)   %(ColorBar(6,150,hp0,hpmax0))\n/      
         \f[color,231,171,109]EP      \_l[48,-]\f[color,default]%(ep0)/%(epmax0)    %(ColorBar(3,150,ep0,epmax0))\n/  
         \f[color,231,171,109]CP      \_l[48,-]\f[color,default]%(cp0)/%(cpmax)    %(ColorBar(9,150,cp0,cpmax))\n/
         \f[color,165,203,214]STR     \_l[48,-]\f[color,default]%(str0) （%(str0_)）\n/
         \f[color,165,203,214]DEF     \_l[48,-]\f[color,default]%(def0) （%(def0_)）\n/
         \f[color,165,203,214]ATS     \_l[48,-]\f[color,default]%(ats0) （%(ats0_)）\n/
         \f[color,165,203,214]ADF     \_l[48,-]\f[color,default]%(adf0) （%(adf0_)）\n/
         \f[color,231,171,109]EXP     \_l[48,-]\f[color,default]%(exp0)    \_l[150,-]\f[color,231,171,109]EXPERIENCE \f[color,default]%(exptotal0)\n/
         \f[color,231,171,109]NEXT    \_l[48,-]\f[color,default]%(nextexp0)\n\n/
         兔子\n/
         \f[color,231,171,109]Level   \_l[48,-]\f[color,default]%(lvl1)\n/
         \f[color,231,171,109]HP      \_l[48,-]\f[color,default]%(hp1)/%(hpmax1)   %(ColorBar(6,150,hp1,hpmax1))\n/ 
         \f[color,231,171,109]EP      \_l[48,-]\f[color,default]%(ep1)/%(epmax1)   %(ColorBar(3,150,ep1,epmax1))\n/
         \f[color,231,171,109]CP      \_l[48,-]\f[color,default]%(cp1)/%(cpmax)   %(ColorBar(9,150,cp1,cpmax))\n/
         \f[color,165,203,214]STR     \_l[48,-]\f[color,default]%(str1) （%(str1_)）\n/
         \f[color,165,203,214]DEF     \_l[48,-]\f[color,default]%(def1) （%(def1_)）\n/
         \f[color,165,203,214]ATS     \_l[48,-]\f[color,default]%(ats1) （%(ats1_)）\n/
         \f[color,165,203,214]ADF     \_l[48,-]\f[color,default]%(adf1) （%(adf1_)）\n/  
         \f[color,231,171,109]EXP     \_l[48,-]\f[color,default]%(exp1)     \_l[150,-]\f[color,231,171,109]EXPERIENCE \f[color,default]%(exptotal1)\n/
         \f[color,231,171,109]NEXT    \_l[48,-]\f[color,default]%(nextexp1)\n/
	 \f[color,231,171,109]金钱    \_l[48,-]%(TOINT(money))"

//_txt += ColorBar(6,200,hp0,hpmax0)
//_txt += ColorBar(3,200,ep0,epmax0)
_txt

}




信息参数
{

weaponA = IARRAY
weaponB = IARRAY
article = IARRAY

weaponA = ("weaponA,0,匕首,%(weaponAnum[0]),1,600,3,7","weaponA,1,黑刃,%(weaponAnum[1]),6,1000,7,10","weaponA,2,军刀,%(weaponAnum[2]),11,2000,10,20","weaponA,3,拳剑,%(weaponAnum[3]),16,5000,20,40","weaponA,4,花剑,%(weaponAnum[4]),21,8000,40,65","weaponA,5,西洋剑,%(weaponAnum[5]),26,9000,65,80","weaponA,6,星透剑,%(weaponAnum[6]),31,10000,80,90","weaponA,7,水纹剑,%(weaponAnum[7]),36,15000,90,120","weaponA,8,水晶剑,%(weaponAnum[8]),41,16000,120,130","weaponA,9,细剑,%(weaponAnum[9]),46,18000,130,150","weaponA,10,弯剑,%(weaponAnum[10]),51,22000,150,180","weaponA,11,长刺剑,%(weaponAnum[11]),56,27000,180,220","weaponA,12,银剑,%(weaponAnum[12]),61,33000,220,270","weaponA,13,诗剑,%(weaponAnum[13]),66,40000,270,320","weaponA,14,军剑,%(weaponAnum[14]),71,46000,320,370","weaponA,15,天琴剑,%(weaponAnum[15]),76,52000,370,420","weaponA,16,七星剑,%(weaponAnum[16]),81,60000,420,460","weaponA,17,亚伦之剑,%(weaponAnum[17]),86,65000,460,500","weaponA,18,古剑,%(weaponAnum[18]),91,70000,500,550","weaponA,19,青龙剑,%(weaponAnum[19]),96,75000,550,600","weaponA,20,常绿,%(weaponAnum[20]),101,80000,600,700","weaponA,21,受难十字剑,%(weaponAnum[21]),106,100000,700,800","weaponA,22,神圣能量剑,%(weaponAnum[22]),111,120000,800,900","weaponA,23,神之骑士剑,%(weaponAnum[23]),116,125000,900,1000","weaponA,24,女武神,%(weaponAnum[24]),121,140000,1100,1100","weaponA,25,常青剑,%(weaponAnum[25]),126,150000,1150,1200","weaponA,26,赛雷斯托,%(weaponAnum[26]),131,160000,1250,1350","weaponA,27,斩首剑,%(weaponAnum[27]),136,170000,1300,400","weaponA,28,断骨剑,%(weaponAnum[28]),141,190000,1450,1550","weaponA,29,神圣新星,%(weaponAnum[29]),146,200000,1500,1600")

weaponB = ("weaponB,0,手枪,%(weaponBnum[0]),1,600,7,3","weaponB,1,刺针枪,%(weaponBnum[1]),6,1000,10,7","weaponB,2,狩猎枪,%(weaponBnum[2]),11,2000,20,10","weaponB,3,刺弹枪,%(weaponBnum[3]),16,5000,40,20","weaponB,4,鹰眼枪,%(weaponBnum[4]),21,8000,65,40","weaponB,5,步枪,%(weaponBnum[5]),26,9000,80,65","weaponB,6,冲锋枪,%(weaponBnum[6]),31,10000,90,80","weaponB,7,激光枪,%(weaponBnum[7]),36,15000,120,90","weaponB,8,离子枪,%(weaponBnum[8]),41,16000,130,120","weaponB,9,等粒子光炮,%(weaponBnum[9]),46,18000,150,130","weaponB,10,幻影,%(weaponBnum[10]),51,22000,180,1505","weaponB,56,灰狼,%(weaponBnum[11]),56,27000,220,180","weaponB,12,火蜥蜴,%(weaponBnum[12]),61,33000,270,220","weaponB,13,骑兵枪,%(weaponBnum[13]),66,40000,320,270","weaponB,14,独眼巨人,%(weaponBnum[14]),71,46000,370,320","weaponB,15,脉冲炮,%(weaponBnum[15]),76,52000,420,370","weaponB,16,毒牙,%(weaponBnum[16]),81,60000,460,420","weaponB,17,天鹰,%(weaponBnum[17]),86,65000,500,460","weaponB,18,诡异之星,%(weaponBnum[18]),91,70000,550,500","weaponB,19,狙击神,%(weaponBnum[19]),96,75000,600,550","weaponB,20,双星,%(weaponBnum[20]),101,80000,700,600","weaponB,21,天鱼,%(weaponBnum[21]),106,100000,800,700","weaponB,22,世界主宰,%(weaponBnum[22]),111,120000,900,800","weaponB,23,毒针-M,%(weaponBnum[23]),116,125000,1000,900","weaponB,24,幻影-S,%(weaponBnum[24]),121,140000,1100,1100","weaponB,25,和平破坏者,%(weaponBnum[25]),126,150000,1200,1150","weaponB,26,暴徒,%(weaponBnum[26]),131,160000,1350,1250","weaponB,27,第五元素-R,%(weaponBnum[27]),136,170000,1400,300","weaponB,28,小夜曲,%(weaponBnum[28]),141,190000,1550,1450","weaponB,29,神圣之光,%(weaponBnum[29]),146,200000,1600,1500")


armorA = ("armorA,0,皮革背心,%(armorAnum[0]),1,100,5,0","armorA,1,金属背心,%(armorAnum[1]),8,800,10,2","armorA,2,皮革上衣,%(armorAnum[2]),16,2000,25,2","armorA,3,防御背心,%(armorAnum[3]),23,5000,45,4","armorA,4,金属夹克,%(armorAnum[4]),31,10000,75,4","armorA,5,防御大衣,%(armorAnum[5]),38,20000,100,6","armorA,6,纤维护铠,%(armorAnum[6]),46,25000,125,0","armorA,7,纤维大衣,%(armorAnum[7]),53,30000,160,4","armorA,8,树脂大衣,%(armorAnum[8]),61,40000,200,6","armorA,9,真空防护服,%(armorAnum[9]),68,50000,250,8","armorA,10,树脂装甲,%(armorAnum[10]),73,65000,310,12","armorA,11,龙皮铠,%(armorAnum[11]),81,75000,350,50","armorA,12,大地女神服,%(armorAnum[12]),88,85000,425,25,10,10","armorA,13,超重装甲服,%(armorAnum[13]),96,90000,455,40","armorA,14,钛服,%(armorAnum[14]),103,95000,500,0","armorA,15,运动外衣,%(armorAnum[15]),111,100000,600,0","armorA,16,龙树连体服,%(armorAnum[16]),118,120000,700,15","armorA,17,无袖外罩,%(armorAnum[17]),126,140000,800,0","armorA,18,汞合金守卫,%(armorAnum[18]),133,160000,900,0","armorA,19,巨人铠甲,%(armorAnum[19]),141,180000,1000,20")

armorB = ("armorB,0,兽皮制服,%(armorBnum[0]),1,200,12,20","armorB,1,锁片薄衣,%(armorBnum[1]),8,1000,30,4","armorB,2,战斗服,%(armorBnum[2]),16,3000,50,6","armorB,3,黑大衣,%(armorBnum[3]),23,10000,80,8","armorB,4,反射大衣,%(armorBnum[4]),31,20000,105,10","armorB,5,女武神铠甲,%(armorBnum[5]),38,25000,120,10","armorB,6,蓝色猿羊绒,%(armorBnum[6]),46,30000,150,35","armorB,7,神圣修女服,%(armorBnum[7]),53,35000,155,50,50","armorB,8,女术士战袍,%(armorBnum[8]),61,45000,210,30","armorB,9,金耀晚礼服,%(armorBnum[9]),68,60000,260,30,50","armorB,10,八卦服,%(armorBnum[10]),73,70000,320,40","armorB,11,金色女伯爵,%(armorBnum[11]),81,80000,380,50,-30,100","armorB,12,女机师战甲,%(armorBnum[12]),88,90000,380,30,50,30","armorB,13,炮术师战甲,%(armorBnum[13]),96,120000,600,200","armorB,14,忍者服,%(armorBnum[14]),103,110000,750,0","armorB,15,可爱猫咪套装,%(armorBnum[15]),111,110000,750,0","armorB,16,黑丝绸,%(armorBnum[16]),118,150000,825,150","armorB,17,宇宙装甲,%(armorBnum[17]),126,200000,1100,0","armorB,18,加百列光辉,%(armorBnum[18]),133,200000,1100,25,0,25","armorB,19,尘世巨蟒,%(armorBnum[19]),141,250000,1600,300")

bootsA=("bootsA,0,皮靴,%(bootsAnum[0]),1,200,2,0","bootsA,1,防滑靴,%(bootsAnum[1]),11,800,4,0","bootsA,2,工作鞋,%(bootsAnum[2]),21,1500,8,1","bootsA,3,双重防滑靴,%(bootsAnum[3]),31,3000,12,1","bootsA,4,手工鞋,%(bootsAnum[4]),41,5000,20,2","bootsA,5,合成防护靴,%(bootsAnum[5]),51,8000,30,2","bootsA,6,金属靴,%(bootsAnum[6]),61,11000,40,0","bootsA,7,纤维靴,%(bootsAnum[7]),71,14000,50,0","bootsA,8,高级皮靴,%(bootsAnum[8]),81,25000,90,1","bootsA,9,忍者短布鞋,%(bootsAnum[8]),91,30000,105,1","bootsA,10,树脂靴,%(bootsAnum[10]),101,35000,130,1","bootsA,11,机械靴,%(bootsAnum[11]),111,45000,180,2","bootsA,12,骑士护腿,%(bootsAnum[12]),121,50000,190,0","bootsA,13,斯托雷加B,%(bootsAnum[13]),131,55000,200,0","bootsA,14,龙神鞋,%(bootsAnum[14]),141,65000,200,10,0,20")

bootsB=("bootsB,0,开孔长靴,%(bootsBnum[0]),1,100,1,3","bootsB,1,编织鞋,%(bootsBnum[1]),11,300,7,1","bootsB,2,工作安全鞋,%(bootsBnum[2]),21,2000,12,0","bootsB,3,军用鞋,%(bootsBnum[3]),31,3000,15,2","bootsB,4,天神之靴,%(bootsBnum[4]),41,10000,35,3","bootsB,5,风神之靴,%(bootsBnum[5]),51,10000,35,3","bootsB,6,流浪者,%(bootsBnum[6]),61,12000,45,3","bootsB,7,双子星,%(bootsBnum[7]),71,15000,55,1","bootsB,8,水晶高跟鞋,%(bootsBnum[8]),81,20000,70,0","bootsB,9,大地护胫,%(bootsBnum[9]),91,30000,100,0","bootsB,10,轻钢靴,%(bootsBnum[10]),101,40000,150,2","bootsB,11,月神之腫,%(bootsBnum[11]),111,50000,160,30,0,30","bootsB,12,英仙神靴,%(bootsBnum[12]),121,55000,205,3","bootsB,13,帕特农神靴,%(bootsBnum[13]),131,70000,195,50","bootsB,14,提坦神靴,%(bootsBnum[14]),141,80000,220,10,0,30")

itemA = ("itemA,0,小回复药,%(itemAnum[0]),50,400","itemA,1,回复药,%(itemAnum[1]),100,1000","itemA,2,中回复药,%(itemAnum[2]),200,3000","itemA,3,大回复药,%(itemAnum[3]),300,6000","itemA,4,超回复药,%(itemAnum[4]),400,HP全回复","itemA,5,复苏药,%(itemAnum[5]),500,战斗不能解除")

itemB = ("itemB,0,小型EP填充剂,%(itemBnum[0]),50,200","itemB,1,EP填充剂,%(itemBnum[1]),100,400","itemB,2,中型EP填充剂,%(itemBnum[2]),200,600","itemB,3,大型EP填充剂,%(itemBnum[3]),300,800","itemB,4,超级EP填充剂,%(itemBnum[4]),400,EP全回复")


magicinfo

}







装备
{


信息参数
RpgGameVar
--

超出反应
 --
_txt = "\n"

_txt += "小缘                                    \_l[140,-]兔子\n/
         武器：\q[%(weapon0),offweapon0]         \_l[140,-]武器：\q[%(weapon1),offweapon1]\n/
         防具（体）：\q[%(armor0),offarmor0]     \_l[140,-]防具（体）：\q[%(armor1),offarmor1]\n/
         防具（脚）：\q[%(boots0),offboots0]     \_l[140,-]防具（脚）：\q[%(boots1),offboots1]\n\n/
        "

/*_txt += "兔子\n/ 
         武器：\q[%(weapon1),offweapon1]\n/
         防具（体）：\q[%(armor1),offarmor1]\n/
         防具（脚）：\q[%(boots1),offboots1]\n/
        "*/
_weapon = (weaponA,weaponB)
_armor = (armorA,armorB)
_boots = (bootsA,bootsB)
//武器=("未装备",weapon)[weaponmode]



  foreach _weapon; _i {
                          
                      
            if _i[3] > 0 {
                       
                 _txt += "%(_i[2])      \_l[80,-]数量%(_i[3])"
                      
          
                         if weapon0==NULL
                               {

                              _txt += "\_l[130,-]\q[小缘未装备,Onweapon0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7])]"
                               }
                         elseif weapon0!=NULL
                               {
                             
                            if weaponID0==_i[1] && weaponsort0==_i[0]
                                            {
                                           
                        _txt += "\_l[130,-]\f[color,231,171,109]\q[小缘已装备,Onweapon0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7])]\f[color,default]"
                                            }
                                 
                           else
                                            {     
                          _txt += "\_l[130,-]\q[小缘未装备,Onweapon0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7])]"
                                            }          
                                }

                           if weapon1==NULL
                                     {
      _txt += "\_l[200,-]\q[兔子未装备,Onweapon1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7])]\n"
                                      }


                            elseif weapon1!=NULL
                                      {        
                                      if weaponID1==_i[1] && weaponsort1==_i[0]
                                             {
                                             
                          _txt += "\_l[200,-]\f[color,231,171,109]\q[兔子已装备,Onweapon1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7])]\f[color,default]\n"
                                             }
                                 
                                     else
                                             {     
                    _txt += "\_l[200,-]\q[兔子未装备,Onweapon1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7])]\n"
                                             }
                                     }   


                          }
            
		   }




              foreach _armor; _i {
                      
          if _i[3] > 0 {
                       
                 _txt += "%(_i[2])      \_l[80,-]数量%(_i[3])"
                      
          
                         if armor0==NULL
                               {

                              _txt += "\_l[130,-]\q[小缘未装备,Onarmor0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]"
                               }
                         elseif armor0!=NULL
                               {
                          
                            if armorID0==_i[1] && armorsort0==_i[0]
                                            {
                                                
                        _txt += "\_l[130,-]\f[color,231,171,109]\q[小缘已装备,Onarmor0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]\f[color,default]"
                                            }
                                 
                           else
                                            {     
                          _txt += "\_l[130,-]\q[小缘未装备,Onarmor0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]"
                                            }          
                                }

                           if armor1==NULL
                                     {
      _txt += "\_l[200,-]\q[兔子未装备,Onarmor1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]\n"
                                      }


                            elseif armor1!=NULL
                                      {        
                                      if armorID1==_i[1] && armorsort1==_i[0]
                                             {
                                                            
                          _txt += "\_l[200,-]\f[color,231,171,109]\q[兔子已装备,Onarmor1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]\f[color,default]\n"
                                                 
                                             }
                                 
                                     else
                                             {     
                    _txt += "\_l[200,-]\q[兔子未装备,Onarmor1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]\n"
                                             }
                                     }   


                          }
            
		   }



   foreach _boots; _i {
                

           if _i[3] > 0 {
                       
                 _txt += "%(_i[2])      \_l[80,-]数量%(_i[3])"
                      
          
                         if boots0==NULL
                               {

                              _txt += "\_l[130,-]\q[小缘未装备,Onboots0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]"
                               }
                         elseif boots0!=NULL
                               {
                          
                            if bootsID0==_i[1] && bootssort0==_i[0]
                          {
                               
                        _txt += "\_l[130,-]\f[color,231,171,109]\q[小缘已装备,Onboots0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]\f[color,default]"
                                            }
                                 
                           else
                                            {     
                          _txt += "\_l[130,-]\q[小缘未装备,Onboots0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]"
                                            }          
                                }

                           if boots1==NULL
                                     {
      _txt += "\_l[200,-]\q[兔子未装备,Onboots1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]\n"
                                      }


                            elseif boots1!=NULL
                                      {        
                                      if bootsID1==_i[1] && bootssort1==_i[0]
                                             {
                                             
                          _txt += "\_l[200,-]\f[color,231,171,109]\q[兔子已装备,Onboots1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]\f[color,default]\n"
                                             }
                                 
                                     else
                                             {     
                    _txt += "\_l[200,-]\q[兔子未装备,Onboots1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[3]),%(_i[6]),%(_i[7]),%(_i[8]),%(_i[9])]\n"
                                             }
                                     }   


                          }
            
		   }





_txt += "\n"




_txt
}


Onweapon0
{
if weapon1==reference2 && reference3<=1
{"\0数量不足，先卸载，后装备\x%(OpenRpgGameMenu(1))"}
else
{

weaponsort0=reference0
weaponID0=reference1
weapon0=reference2
if weaponsort0=="weaponA"
{
weaponequip_str0=reference4
}
elseif weaponsort0=="weaponB"
{
weaponequip_str0=1.2*reference4
}

weaponequip_ats0=reference5
OpenRpgGameMenu(1)
}

}

Onweapon1
{
   if weapon0==reference2 && reference3<=1
          {"\0数量不足，先卸载，后装备\x%(OpenRpgGameMenu(1))"}
   else
          {
weaponsort1=reference0
weaponID1=reference1
weapon1=reference2
if weaponsort1=="weaponA"
{
weaponequip_ats1=1.2*reference5
}
elseif weaponsort0=="weaponB"
{
weaponequip_ats1=reference5
}
weaponequip_str1=reference4
OpenRpgGameMenu(1)
          }
}


Onarmor0
{
      if armor1==reference2 && reference3<=1
          {"\0数量不足，先卸载，后装备\x%(OpenRpgGameMenu(1))"}
      else
          {
armorsort0=reference0

armorID0=reference1
armor0=reference2
armorequip_def0=reference4
armorequip_adf0=reference5
armorequip_str0=reference6
armorequip_ats0=reference7

OpenRpgGameMenu(1)
           }
}

Onarmor1
{
        if armor0==reference2 && reference3<=1
             {"\0数量不足，先卸载，后装备\x%(OpenRpgGameMenu(1))"}
        else
             {
armorsort1=reference0

armorID1=reference1
armor1=reference2
armorequip_def1=reference4
armorequip_adf1=reference5
armorequip_str1=reference6
armorequip_ats1=reference7
OpenRpgGameMenu(1)
             }
}

Onboots0
{
        if boots1==reference2 && reference3<=1
              {"\0数量不足，先卸载，后装备\x%(OpenRpgGameMenu(1))"}
        else
              {
bootssort0=reference0

bootsID0=reference1
boots0=reference2
bootsequip_def0=reference4
bootsequip_adf0=reference5
bootsequip_ats0=reference7



OpenRpgGameMenu(1)
               }
}

Onboots1
{
        if boots0==reference2 && reference3<=1
               {"\0数量不足，先卸载，后装备\x%(OpenRpgGameMenu(1))"}

        else
               {
bootssort1=reference0

bootsID1=reference1
boots1=reference2
bootsequip_def1=reference4
bootsequip_adf1=reference5
bootsequip_ats1=reference7

OpenRpgGameMenu(1)
               }
}


Select.offweapon0
{
weapon0=NULL
weaponID0=NULL
weaponequip_str0=0
weaponequip_ats0=0
OpenRpgGameMenu(1)
}


Select.offweapon1
{
weapon1=NULL
weaponID1=NULL
weaponequip_str1=0
weaponequip_ats1=0
OpenRpgGameMenu(1)
}

Select.offarmor0
{
armor0=NULL
armorID0=NULL
armorequip_def0=0
armorequip_adf0=0
OpenRpgGameMenu(1)
}

Select.offarmor1
{
armor1=NULL
armorID1=NULL
armorequip_def1=0
armorequip_adf1=0
OpenRpgGameMenu(1)
}

Select.offboots0
{
boots0=NULL
bootsID0=NULL
bootsequip_def0=0
bootsequip_adf0=0
OpenRpgGameMenu(1)
}


Select.offboots1
{
boots1=NULL
bootsID1=NULL
bootsequip_def1=0
bootsequip_adf1=0
OpenRpgGameMenu(1)
}





magicinfo
{
水系魔法=("水系魔法,0,回复术,回复,单体,1,10,400","水系魔法,1,中回复术,回复,单体,20,20,1000","水系魔法,2,大回复术,回复,单体,40,40,3000","水系魔法,3,超回复术,回复,单体,60,60,HP全回复","水系魔法,4,回复术·复,回复,复体,12,20,400","水系魔法,5,中回复术·复,回复,复体,32,50,1000","水系魔法,6,大回复术·复,回复,复体,52,50,3000","水系魔法,7,超回复术·复,回复,复体,72,60,HP全回复","水系魔法,8,复苏术,回复,单体,30,50,战斗不能解除","水系魔法,9,水之矢,攻击,单体,1,10,0,1","水系魔法,10,冰蓝冲击,攻击,单体,26,20,130,2.3","水系魔法,11,水蓝轰炸,攻击,单体,44,40,220,3.2")


火系魔法=("火系魔法,0,火之矢,攻击,单体,1,10,-25,1","火系魔法,1,炎之箭,攻击,单体,16,20,80,1.8","火系魔法,2,火之矢·改,攻击,单体,20,20,100,2","火系魔法,3,燃烧之息,攻击,单体,52,40,260,3.6","火系魔法,4,火山之咆哮,攻击,单体,64,50,320,4.2","火系魔法,5,龙卷火焰,攻击,单体,80,60,400,5")

土系魔法=("土系魔法,0,石之锤,攻击,单体,1,10,0,1","土系魔法,1,岩石之息,攻击,单体,4,10,20,1.2","土系魔法,2,陨石冲击,攻击,单体,6,10,30,1.3","土系魔法,3,岩石之云,攻击,单体,14,20,70,1.7","土系魔法,4,大地之枪,攻击,单体,28,20,140,2.4","土系魔法,5,泰坦之咆哮,攻击,单体,40,30,200,3","土系魔法,6,大地之毁灭,攻击,单体,52,40,300,4")

风系魔法=("风系魔法,0,风之轮,攻击,单体,1,10,-25,1","风系魔法,1,风之领域,攻击,单体,5,10,25,1.25","风系魔法,2,狂怒风暴,攻击,单体,26,20,130,2.3","风系魔法,3,天龙卷,攻击,单体,34,20,170,2.7","风系魔法,4,等离子之波,攻击,单体,48,30,240,3.4","风系魔法,5,审判之雷,攻击,单体,72,60,360,4.6")


}



魔法
{
battlemode=0
On魔法列表
}



On魔法列表
{
"\b[2]\![quicksession,true]"
--
magicinfo
if magicMenu == 0{
		"\n" + ColorText("\__q[OnmagicMenu,1]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────小缘↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
               magicMenu0
 

	}
	elseif magicMenu == 1 {
		"\n" + ColorText("\__q[OnmagicMenu,0]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────兔子↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
		magicMenu1;
	}

      
}

OnmagicMenu
{

	magicMenu = reference0;
       if battlemode==0
         {
	OpenRpgGameMenu(2);
         }
        elseif battlemode==2
         {
         On魔法列表

         }
}


magicMenu0
{
   
_txt="\n"

_txt+="\_l[0,-]魔法名称     \_l[80,-]属性    \_l[115,-]范围     \_l[145,-]消耗EP     \_l[185,-]效果\n" 
_txt+="\_l[120,-]\f[color,65,203,214]水系魔法\f[color,default]\n"

foreach 水系魔法; _i {
                         if lvl0>=TOINT(_i[5])
                               {
		             if _i[3] == "回复"     {
                       
                 _txt += "\_l[0,-]\f[color,65,203,214]%(_i[2])\f[color,default]      \f[color,65,203,214]\_l[80,-]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])     \_l[185,-]%(_i[7])     \_l[260,-]\q[使用,Onusemagic0,%(_i[0]),%(_i[2]),%(_i[3]),%(_i[4]),%(_i[5]),%(_i[6]),%(_i[7])]\n"
                                                    }

                            elseif _i[3] == "攻击"  {
                 _txt += "\_l[0,-]\f[color,65,203,214]%(_i[2])\f[color,default]      \_l[80,-]\f[color,255,0,0]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])   \_l[185,-]%(_i[7])\n"
        
                                                    }
                               }
                     }


_txt+="\_l[120,-]\f[color,255,0,0]火系魔法\f[color,default]\n"

foreach 火系魔法; _i {
                         if lvl0>=TOINT(_i[5])
                          {   
                 _txt += "\_l[0,-]\f[color,255,0,0]%(_i[2])\f[color,default]      \_l[80,-]\f[color,255,0,0]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])  \_l[185,-]%(_i[7]) \n"
                          }              
                               
                     }


_txt+="\_l[120,-]\f[color,231,171,109]土系魔法\f[color,default]\n"

foreach 土系魔法; _i {
                         if lvl0>=TOINT(_i[5])
                          {   
                 _txt += "\_l[0,-]\f[color,231,171,109]%(_i[2])\f[color,default]      \_l[80,-]\f[color,255,0,0]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])  \_l[185,-]%(_i[7]) \n"
                          }              
                               
                     }



_txt+="\_l[120,-]\f[color,194,243,99]风系魔法\f[color,default]\n"

foreach 风系魔法; _i {
                         if lvl0>=TOINT(_i[5])
                          {   
                 _txt += "\_l[0,-]\f[color,194,243,99]%(_i[2])\f[color,default]      \_l[80,-]\f[color,255,0,0]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])  \_l[185,-]%(_i[7]) \n"
                          }              
                               
                     }

if battlemode==2
{
_txt+="\_l[-,300]\q[返回,On休息]"

}

_txt
	

}




magicMenu1
{
_txt="\n"

_txt+="\_l[0,-]魔法名称     \_l[80,-]属性    \_l[115,-]范围     \_l[145,-]消耗EP     \_l[185,-]效果\n" 
_txt+="\_l[120,-]\f[color,65,203,214]水系魔法\f[color,default]\n"

foreach 水系魔法; _i {
                         if lvl1>=TOINT(_i[5])
                               {
		             if _i[3] == "回复"     {
                       
                 _txt += "\_l[0,-]\f[color,65,203,214]%(_i[2])\f[color,default]      \f[color,65,203,214]\_l[80,-]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])     \_l[185,-]%(_i[7])     \_l[260,-]\q[使用,Onusemagic1,%(_i[0]),%(_i[2]),%(_i[3]),%(_i[4]),%(_i[5]),%(_i[6]),%(_i[7])]\n"
                                                    }

                            elseif _i[3] == "攻击"  {
                 _txt += "\_l[0,-]\f[color,65,203,214]%(_i[2])\f[color,default]      \_l[80,-]\f[color,255,0,0]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])   \_l[185,-]%(_i[7])\n"
        
                                                    }
                               }
                     }


_txt+="\_l[120,-]\f[color,255,0,0]火系魔法\f[color,default]\n"

foreach 火系魔法; _i {
                         if lvl1>=TOINT(_i[5])
                          {   
                 _txt += "\_l[0,-]\f[color,255,0,0]%(_i[2])\f[color,default]      \_l[80,-]\f[color,255,0,0]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])  \_l[185,-]%(_i[7]) \n"
                          }              
                               
                     }


_txt+="\_l[120,-]\f[color,231,171,109]土系魔法\f[color,default]\n"

foreach 土系魔法; _i {
                         if lvl1>=TOINT(_i[5])
                          {   
                 _txt += "\_l[0,-]\f[color,231,171,109]%(_i[2])\f[color,default]      \_l[80,-]\f[color,255,0,0]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])  \_l[185,-]%(_i[7]) \n"
                          }              
                               
                     }



_txt+="\_l[120,-]\f[color,194,243,99]风系魔法\f[color,default]\n"

foreach 风系魔法; _i {
                         if lvl1>=TOINT(_i[5])
                          {   
                 _txt += "\_l[0,-]\f[color,194,243,99]%(_i[2])\f[color,default]      \_l[80,-]\f[color,255,0,0]%(_i[3])\f[color,default]    \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])  \_l[185,-]%(_i[7]) \n"
                          }              
                               
                     }


if battlemode==2
{
_txt+="\_l[-,300]\q[返回,On休息]"

}

_txt
	

}







Onusemagic0
{

  if reference2=="回复" && reference3=="单体"

      {
    "给谁使用\n/
   \q[小缘,Onkikka0,%(reference0),%(reference1),%(reference2),%(reference3),%(reference4),%(reference5),%(reference6)]\n/
    \q[兔子,Ontowa0,%(reference0),%(reference1),%(reference2),%(reference3),%(reference4),%(reference5),%(reference6)]\n/
    \n\n\n\n\q[返回,Onbackusemagic0]"
      }

   
   elseif reference2=="回复" && reference3=="复体"
      {

      Ondouble0(reference0,reference1,reference2,reference3,reference4,reference5,reference6)

      }


  elseif reference2=="攻击"
     {
       Onmagicatk0(reference0,reference1,reference2,reference3,reference4,reference5,reference6,reference7)
     } 
}




Onusemagic1
{

  if reference2=="回复" && reference3=="单体"

      {
    "给谁使用\n/
   \q[小缘,Onkikka1,%(reference0),%(reference1),%(reference2),%(reference3),%(reference4),%(reference5),%(reference6)]\n/
    \q[兔子,Ontowa1,%(reference0),%(reference1),%(reference2),%(reference3),%(reference4),%(reference5),%(reference6)]\n/
    \n\n\n\n\q[返回,Onbackusemagic1]"
      }



 
    elseif reference2=="回复" && reference3=="复体"
      {

      Ondouble1(reference0,reference1,reference2,reference3,reference4,reference5,reference6)

      }


    elseif reference2=="攻击"
     {
       Onmagicatk1(reference0,reference1,reference2,reference3,reference4,reference5,reference6,reference7)
     } 
}


Onbackusemagic0
{
if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
           elseif battlemode==2
       {
        On休息
       }
     else
       {        
         Onbattleselect0
       } 


}

Onbackusemagic1
{

if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
           elseif battlemode==2
       {
        On休息
       }
     else
       {        
         Onbattleselect1
       } 


}




Onkikka0
{

魔法名称=reference1
效果数值=TOINT(reference6)

EP消耗=TOINT(reference5)


     if reference6=="HP全回复" && ep0>=EP消耗
      {

       "小缘对自己使用了%(魔法名称)，HP回复%(hpmax0-hp0)\x"
        hp0=hpmax0
         ep0-=EP消耗

       --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
      elseif battlemode==2
       {
        On休息
       }
     else
       {        
        if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 


       }

           elseif reference6=="战斗不能解除" && ep0>=EP消耗
      {

       "不能这样使用%(魔法名称)\x"
    
          --
        if battlemode==0
           {
           OpenRpgGameMenu(2);
           }
            elseif battlemode==2
       {
        On休息
       }
        else
           {        
           Onbattleselect0
           } 


       }





     elseif hp0+效果数值>=hpmax0 && ep0>=EP消耗
      {
        "小缘对自己使用了%(魔法名称)，HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         ep0-=EP消耗

         --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
     elseif battlemode==2
       {
        On休息
       }

     else
       {        
         if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 

      }

     elseif hp0+效果数值<hpmax0 && ep0>=EP消耗
      {
         hp0+=效果数值
         "小缘对自己使用了%(魔法名称)，HP回复%(效果数值)\x"
         ep0-=EP消耗

       --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
    elseif battlemode==2
       {
        On休息
       }
     else
       {        
         if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 
      }



      else
        {"EP不足，不能驱动魔法\x"
          
             --
           if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
           elseif battlemode==2
       {
        On休息
       }
     else
       {        
         Onbattleselect0
       } 

        }


 
     
}

Onkikka1
{

魔法名称=reference1
效果数值=TOINT(reference6)

EP消耗=TOINT(reference5)

if hp0>0
{

     if reference6=="HP全回复" && ep1>=EP消耗
      {

       "兔子对小缘使用了%(魔法名称)，HP回复%(hpmax0-hp0)\x"
        hp0=hpmax0
         ep1-=EP消耗
            --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
         elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 
     }


           elseif reference6=="战斗不能解除" && ep1>=EP消耗
      {

       "不能这样使用%(魔法名称)\x"
    
          --
        if battlemode==0
           {
           OpenRpgGameMenu(2);
           }
            elseif battlemode==2
       {
        On休息
       }
        else
           {        
           Onbattleselect1
           } 


       }




     elseif hp0+效果数值>=hpmax0 && ep1>=EP消耗
      {
        "兔子对小缘使用了%(魔法名称)，HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         ep1-=EP消耗

           --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 
      }

     elseif hp0+效果数值<hpmax0 && ep1>=EP消耗
      {
         hp0+=效果数值
         "兔子对小缘使用了%(魔法名称)，HP回复%(效果数值)\x"
         ep1-=EP消耗
            --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 

      }


    

      else
        {"EP不足，不能驱动魔法\x"
               --


          if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
             elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect1
             } 


        }

  
}


    elseif hp0==0 && reference6=="战斗不能解除" && ep1>=EP消耗
    {
   
       "兔子对小缘使用了%(魔法名称)，小缘恢复战斗能力，HP回复%(hpmax0-hp0)\x"
        hp0=hpmax0
         ep1-=EP消耗
            --
          
         怪物反击
    }

       elseif  ep1<EP消耗
             {
          "EP不足，不能驱动魔法\x"
               --
               




              if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
             elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect1
             } 

             } 

else
   {
   "不能对失去战斗能力的小缘使用%(魔法名称)\x"
   
   --

  if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
             elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect1
             } 


   }


}





Ontowa0
{

魔法名称=reference1
效果数值=TOINT(reference6)

EP消耗=TOINT(reference5)

if hp1>0
{

     
      if reference6=="HP全回复" && ep0>=EP消耗
      {

       "小缘对兔子使用了%(魔法名称)，HP回复%(hpmax1-hp1)\x"
        hp1=hpmax1
         ep0-=EP消耗

            --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 


       }

     
          elseif reference6=="战斗不能解除" && ep0>=EP消耗
      {

       "不能这样使用%(魔法名称)\x"
    
          --
        if battlemode==0
           {
           OpenRpgGameMenu(2);
           }
            elseif battlemode==2
       {
        On休息
       }
        else
           {        
           Onbattleselect0
           } 


       }




     elseif hp1+效果数值>=hpmax1 && ep0>=EP消耗
      {
        "小缘对兔子使用了%(魔法名称)，HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         ep0-=EP消耗
            --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 


      }

     elseif hp1+效果数值<hpmax1 && ep0>=EP消耗
      {
         hp1+=效果数值
         "小缘对兔子使用了%(魔法名称)，HP回复%(效果数值)\x"
         ep0-=EP消耗

            --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
         elseif battlemode==2
       {
        On休息
       }
     else
       {        
        if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 

      }



      else
        {"EP不足，不能驱动魔法\x"
                --
           if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
              elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect0
             } 


        }

}



    elseif hp1==0 && reference6=="战斗不能解除" && ep0>=EP消耗
    {
   
       "小缘对兔子使用了%(魔法名称)，兔子恢复战斗能力，HP回复%(hpmax1-hp1)\x"
        hp1=hpmax1
         ep0-=EP消耗
            --
           
          if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
             elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect1
             } 

        


    }

       elseif  ep0<EP消耗
             {
          "EP不足，不能驱动魔法\x"
               --
               
               if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
             elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect0
             } 

             } 

else
   {
   "不能对失去战斗能力的兔子使用%(魔法名称)\x"
   
   --

     if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
             elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect0
             } 

   }

    
}


Ontowa1
{

魔法名称=reference1
效果数值=TOINT(reference6)

EP消耗=TOINT(reference5)

       if reference6=="HP全回复" && ep1>=EP消耗
      {

       "兔子对自己使用了%(魔法名称)，HP回复%(hpmax1-hp1)\x"
        hp1=hpmax1
         ep1-=EP消耗

          --
        if battlemode==0
           {
           OpenRpgGameMenu(2);
           }
            elseif battlemode==2
       {
        On休息
       }
        else
           {        
           怪物反击
           } 


       }

     elseif reference6=="战斗不能解除" && ep1>=EP消耗
      {

       "不能这样使用%(魔法名称)\x"
    
          --
        if battlemode==0
           {
           OpenRpgGameMenu(2);
           }
            elseif battlemode==2
       {
        On休息
       }
        else
           {        
           Onbattleselect1
           } 


       }




     elseif hp1+效果数值>=hpmax1 && ep1>=EP消耗
      {
        "兔子对自己使用了%(魔法名称)，HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         ep1-=EP消耗

        
          --
        if battlemode==0
           {
           OpenRpgGameMenu(2);
           }
             elseif battlemode==2
       {
        On休息
       }
        else
           {        
           怪物反击
           } 

      }

     elseif hp1+效果数值<hpmax1 && ep1>=EP消耗
      {
         hp1+=效果数值
         "兔子对自己使用了%(魔法名称)，HP回复%(效果数值)\x"
         ep1-=EP消耗

         
        --
        if battlemode==0
           {
           OpenRpgGameMenu(2);
           }
           elseif battlemode==2
       {
        On休息
       }
        else
           {        
           怪物反击
           } 

      }


   

      else
        {"EP不足，不能驱动魔法\x"
            
                --
          if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
                 elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect1
             } 
        }


}


Ondouble0
{
魔法名称=_argv[1]
效果数值=TOINT(_argv[6])

EP消耗=TOINT(_argv[5])

if hp1>0
{
      if _argv[6]=="HP全回复" && ep0>=EP消耗
     {
        "小缘使用了%(魔法名称)，小缘HP回复%(hpmax0-hp0)，兔子HP回复%(hpmax1-hp1)\x"
         hp0=hpmax0
         hp1=hpmax1
         ep0-=EP消耗
       --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
          elseif battlemode==2
       {
        On休息
       }
     else
       {        
         if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 


      }




     elseif hp0+效果数值>=hpmax0 &&  hp1+效果数值>=hpmax1 && ep0>=EP消耗
      {
        "小缘使用了%(魔法名称)，小缘HP回复%(hpmax0-hp0)，兔子HP回复%(hpmax1-hp1)\x"
         hp0=hpmax0
         hp1=hpmax1
         ep0-=EP消耗
       --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
        if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 


      }

     elseif hp0+效果数值<hpmax0 && hp1+效果数值<hpmax1 && ep0>=EP消耗
      {
         hp0+=效果数值
         hp1+=效果数值
         "小缘使用了%(魔法名称)，小缘HP回复%(效果数值)，兔子HP回复%(效果数值)\x"
         ep0-=EP消耗

      --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
        if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 

      }

     elseif hp0+效果数值>=hpmax0 &&  hp1+效果数值<hpmax1 && ep0>=EP消耗
      {
       
     "小缘使用了%(魔法名称)，小缘HP回复%(hpmax0-hp0)，兔子HP回复%(效果数值)\x"
        hp0=hpmax0
        hp1+=效果数值
        ep0-=EP消耗
       --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
          elseif battlemode==2
       {
        On休息
       }
     else
       {        
         if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 


      }


       elseif hp0+效果数值<hpmax0 &&  hp1+效果数值>=hpmax1 && ep0>=EP消耗
      {
       
     "小缘使用了%(魔法名称)，小缘HP回复%(效果数值)，兔子HP回复%(hpmax1-hp1)\x"
      hp0+=效果数值
      hp1=hpmax1
      ep0-=EP消耗
     --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 


      }

 




      else
        {"EP不足，不能驱动魔法\x"
          
             --
           if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
              elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect0
             } 

        }
}


elseif hp1==0
   {
 if _argv[6]=="HP全回复" && ep0>=EP消耗
        {
        "小缘使用了%(魔法名称)，HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         ep0-=EP消耗
       --
        if battlemode==0
            {
           OpenRpgGameMenu(2);
            }
            elseif battlemode==2
       {
        On休息
       }
        else
            {        
           if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
            } 
 

        }


elseif hp0+效果数值>=hpmax0  && ep0>=EP消耗
      {
        "小缘使用了%(魔法名称)，HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         ep0-=EP消耗
       --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 


      }

     elseif hp0+效果数值<hpmax0 && ep0>=EP消耗
      {
         hp0+=效果数值
         "小缘使用了%(魔法名称)，HP回复%(效果数值)\x"
         ep0-=EP消耗

      --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
     elseif battlemode==2
       {
        On休息
       }
     else
       {        
         if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       } 

      }


   }
  
}


Ondouble1
{
魔法名称=_argv[1]
效果数值=TOINT(_argv[6])

EP消耗=TOINT(_argv[5])

if hp0>0
{
     if _argv[6]=="HP全回复" && ep1>=EP消耗
     {
        "兔子使用了%(魔法名称)，小缘HP回复%(hpmax0-hp0)，兔子HP回复%(hpmax1-hp1)\x"
         hp0=hpmax0
         hp1=hpmax1
         ep1-=EP消耗

        
     --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }

        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 

      }



     elseif hp0+效果数值>=hpmax0 &&  hp1+效果数值>=hpmax1 && ep1>=EP消耗
      {
        "兔子使用了%(魔法名称)，小缘HP回复%(hpmax0-hp0)，兔子HP回复%(hpmax1-hp1)\x"
         hp0=hpmax0
         hp1=hpmax1
         ep1-=EP消耗

        
     --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 

      }

     elseif hp0+效果数值<hpmax0 && hp1+效果数值<hpmax1 && ep1>=EP消耗
      {
         hp0+=效果数值
         hp1+=效果数值
         "兔子使用了%(魔法名称)，小缘HP回复%(效果数值)，兔子HP回复%(效果数值)\x"
         ep1-=EP消耗

        
     --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 

      }

     elseif hp0+效果数值>=hpmax0 &&  hp1+效果数值<hpmax1 && ep1>=EP消耗
      {
       
     "兔子使用了%(魔法名称)，小缘HP回复%(hpmax0-hp0)，兔子HP回复%(效果数值)\x"
        hp0=hpmax0
        hp1+=效果数值
        ep1-=EP消耗

       
     --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 

      }


       elseif hp0+效果数值<hpmax0 &&  hp1+效果数值>=hpmax1 && ep1>=EP消耗
      {
       
     "兔子使用了%(魔法名称)，小缘HP回复%(效果数值)，兔子HP回复%(hpmax1-hp1)\x"
      hp0+=效果数值
      hp1=hpmax1
      ep1-=EP消耗

       
     --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
        elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 

      }

    
      else
        {"EP不足，不能驱动魔法\x"
          
             --
           if battlemode==0
             {
              OpenRpgGameMenu(2);
             }
              elseif battlemode==2
       {
        On休息
       }
           else
             {        
             Onbattleselect1
             } 

        }
}



   elseif hp0==0
   {


     if _argv[6]=="HP全回复" && ep1>=EP消耗
     {
        "兔子使用了%(魔法名称)，HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         ep1-=EP消耗

        
     --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
          elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 

      }



     elseif hp1+效果数值>=hpmax1 && ep1>=EP消耗
      {
        "兔子使用了%(魔法名称)，HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         ep1-=EP消耗

        
     --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
          elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 

      }

     elseif hp1+效果数值<hpmax1 && ep1>=EP消耗
      {
         hp1+=效果数值
         "兔子使用了%(魔法名称)，HP回复%(效果数值)\x"
         ep1-=EP消耗

        
     --
     if battlemode==0
       {
        OpenRpgGameMenu(2);
       }
          elseif battlemode==2
       {
        On休息
       }
     else
       {        
         怪物反击
       } 

      }



   }

}


准备魔法0
{
magicready0=0
 mhp-=魔法伤害0
       ep0-=EP消耗
      "小缘对%(怪物名字)使用了%(魔法名称0)，%(怪物名字)损血%(魔法伤害0)\x"

           --
                if 魔法伤害1>=TOINT(0.33*mhpmax)   
                 {
                 cp0+=3 
                 } 
                else
                 {
                 cp0+=10   
                 }

--
                      if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }


}
准备魔法1
{
magicready1=0
mhp-=魔法伤害1
       ep1-=EP消耗
      "兔子对%(怪物名字)使用了%(魔法名称1)，%(怪物名字)损血%(魔法伤害1)\x"


         --
         if 魔法伤害1>=TOINT(0.33*mhpmax)    
                 {
                 cp1+=3 
                 } 
                else
                 {
                 cp1+=10   
                 }



            --   
          怪物反击
                    

}

Onmagicatk0
{
魔法种类=_argv[0]
魔法名称0=_argv[1]
效果数值=TOINT(_argv[6])
NUMS=_argv[7]
EP消耗=TOINT(_argv[5])


    if ep0>=EP消耗
      {
       if 魔法种类=="水系魔法"
         {
         魔法伤害=TOINT(ANG*NUMS*水有效率*(4.10*ats0-2.80*madf+效果数值))
         }

       elseif 魔法种类=="火系魔法"
         {
         魔法伤害=TOINT(ANG*NUMS*火有效率*(4.10*ats0-2.80*madf+效果数值))
         }

       elseif 魔法种类=="土系魔法"
         {
         魔法伤害=TOINT(ANG*NUMS*土有效率*(4.10*ats0-2.80*madf+效果数值))
         }


        elseif 魔法种类=="风系魔法"
         {
         魔法伤害=TOINT(ANG*NUMS*风有效率*(4.10*ats0-2.80*madf+效果数值))
         }

         if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
        magicready0=1
      魔法伤害0=魔法伤害
        "小缘正在准备魔法\x"
      --
   if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
                  
      }

   else
        {"EP不足，不能驱动魔法\x"
          
                --
             Onbattleselect0
             

        }

                         
       
                    


}



Onmagicatk1
{

魔法种类=_argv[0]
魔法名称1=_argv[1]
效果数值=TOINT(_argv[6])
NUMS=_argv[7]
EP消耗=TOINT(_argv[5])



    if ep1>=EP消耗
      {

       if 魔法种类=="水系魔法"
         {
         魔法伤害=TOINT(ANG*NUMS*水有效率*(4.10*ats1-2.80*madf+效果数值))
         }

       elseif 魔法种类=="火系魔法"
         {
         魔法伤害=TOINT(ANG*NUMS*火有效率*(4.10*ats1-2.80*madf+效果数值))
         }

       elseif 魔法种类=="土系魔法"
         {
         魔法伤害=TOINT(ANG*NUMS*土有效率*(4.10*ats1-2.80*madf+效果数值))
         }


        elseif 魔法种类=="风系魔法"
         {
         魔法伤害=TOINT(ANG*NUMS*风有效率*(4.10*ats1-2.80*madf+效果数值))
         }
       if 魔法伤害<0
                               {
                               魔法伤害=0
                               }

           magicready1=1
      魔法伤害1=魔法伤害
        "兔子正在准备魔法\x"
       --
 怪物反击
        
      }

   else
        {"EP不足，不能驱动魔法\x"
        --
             Onbattleselect1

        }  



}

道具
{

battlemode=0
On道具列表
}



On道具列表
{

信息参数
_txt="\b[2]\![quicksession,true]\n"

_txt+="\_l[0,-]名称    \_l[80,-]效果   \_l[160,-]买入价格 \_l[215,-]已有数量  \n     "
foreach itemA; _i {
                       if _i[3]>0 
                             {
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[160,-]%(_i[4])  \_l[215,-]%(_i[3]) \_l[260,-] \q[使用,Onuseitemselect,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[5])]\n"
                             }

   
                  }

foreach itemB; _i {
                         if _i[3]>0 
                             {
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[160,-]%(_i[4])  \_l[215,-]%(_i[3]) \_l[260,-] \q[使用,Onuseitemselect,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[5])]\n"
		            }
                  }

if battlemode==2
{
_txt+="\_l[-,300]\q[返回,On休息]"

}

_txt




}


Onuseitemselect
{
     "给谁使用\n/
   \q[小缘,Onuseitem0,%(reference0),%(reference1),%(reference2),%(reference3)]\n/
    \q[兔子,Onuseitem1,%(reference0),%(reference1),%(reference2),%(reference3)]\n/
    \n[half]\q[返回,OnRpgGame,3]"



}

Onuseitemselect0
{
     "给谁使用\n/
   \q[小缘,Onkikkauseitem0,%(reference0),%(reference1),%(reference2),%(reference3)]\n/
    \q[兔子,Onkikkauseitem1,%(reference0),%(reference1),%(reference2),%(reference3)]\n/
    \n[half]\q[返回,item0]"




}



Onuseitemselect1
{
     "给谁使用\n/
   \q[小缘,Ontowauseitem0,%(reference0),%(reference1),%(reference2),%(reference3)]\n/
    \q[兔子,Ontowauseitem1,%(reference0),%(reference1),%(reference2),%(reference3)]\n/
    \n[half]\q[返回,item1]"
}



Onuseitem0
{
道具类型=reference0
道具代码=reference1
道具名称=reference2
效果数值=TOINT(reference3)

  if 道具类型=="itemA"
   {
     if reference3=="HP全回复"||reference3=="战斗不能解除"
      {
       "对小缘使用了%(道具名称),HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         itemAnum[道具代码]-=1
      }


     elseif hp0+效果数值>=hpmax0
      {
        "对小缘使用了%(道具名称),HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         itemAnum[道具代码]-=1
      }

     elseif hp0+效果数值<hpmax0
      {
         hp0+=效果数值
         "对小缘使用了%(道具名称),HP回复%(效果数值)\x"
         itemAnum[道具代码]-=1
      }
    }
  elseif 道具类型=="itemB"
  {

      if reference3=="EP全回复"
      {
       "对小缘使用了%(道具名称),EP回复%(epmax0-ep0)\x"
         ep0=epmax0
         itemBnum[道具代码]-=1
      }



     elseif ep0+效果数值>=epmax0
      {
        "对小缘使用了%(道具名称),EP回复%(epmax0-ep0)\x"
         ep0=epmax0
         itemBnum[道具代码]-=1
      }

     elseif ep0+效果数值<epmax0
      {
         ep0+=效果数值
         "对小缘使用了%(道具名称),EP回复%(效果数值)\x"
         itemBnum[道具代码]-=1
      }
    }

--
           if battlemode==0
       {
        OpenRpgGameMenu(3);
       }
     elseif battlemode==2
       {        
         On休息
       } 


}


Onuseitem1
{
道具类型=reference0
道具代码=reference1
道具名称=reference2
效果数值=TOINT(reference3)

  if 道具类型=="itemA"
   {
     if reference3=="HP全回复"||reference3=="战斗不能解除"
      {
       "对兔子使用了%(道具名称),HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         itemAnum[道具代码]-=1
      }




     elseif hp1+效果数值>=hpmax1
      {
        "对兔子使用了%(道具名称),HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         itemAnum[道具代码]-=1
      }

     elseif hp1+效果数值<hpmax1
      {
         hp1+=效果数值
         "对兔子使用了%(道具名称),HP回复%(效果数值)\x"
         itemAnum[道具代码]-=1
      }
    }
  elseif 道具类型=="itemB"
  {
     if reference3=="EP全回复"
      {
       "对兔子使用了%(道具名称),EP回复%(epmax1-ep1)\x"
         ep1=epmax1
         itemBnum[道具代码]-=1
      }



     elseif ep1+效果数值>=epmax1
      {
        "对兔子使用了%(道具名称),EP回复%(epmax1-ep1)\x"
         ep1=epmax1
         itemBnum[道具代码]-=1
      }

     elseif ep1+效果数值<epmax1
      {
         ep1+=效果数值
         "对兔子使用了%(道具名称),EP回复%(效果数值)\x"
         itemBnum[道具代码]-=1
      }
    }

--
	     if battlemode==0
       {
        OpenRpgGameMenu(3);
       }
    elseif battlemode==2
       {        
         On休息
       } 


}


Onkikkauseitem0
{
道具类型=reference0
道具代码=reference1
道具名称=reference2
效果数值=TOINT(reference3)

  if 道具类型=="itemA"
   {

     if reference3=="HP全回复"||reference3=="战斗不能解除"
      {
       "小缘对自己使用了%(道具名称),HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         itemAnum[道具代码]-=1
      }


     elseif hp0+效果数值>=hpmax0
      {
        "小缘对自己使用了%(道具名称),HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         itemAnum[道具代码]-=1
      }

     elseif hp0+效果数值<hpmax0
      {
         hp0+=效果数值
         "小缘对自己使用了%(道具名称),HP回复%(效果数值)\x"
         itemAnum[道具代码]-=1
      }
    }
  elseif 道具类型=="itemB"
  {

     
      if reference3=="EP全回复"
      {
       "小缘对自己使用了%(道具名称),EP回复%(epmax0-ep0)\x"
         ep0=epmax0
         itemBnum[道具代码]-=1
      }

     elseif ep0+效果数值>=epmax0
      {
        "小缘对自己使用了%(道具名称),EP回复%(epmax0-ep0)\x"
         ep0=epmax0
         itemBnum[道具代码]-=1
      }

     elseif ep0+效果数值<epmax0
      {
         ep0+=效果数值
         "小缘对自己使用了%(道具名称),EP回复%(效果数值)\x"
         itemBnum[道具代码]-=1
      }
    }

--
	if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }

}



Onkikkauseitem1
{
道具类型=reference0
道具代码=reference1
道具名称=reference2
效果数值=TOINT(reference3)

 if hp1>0
 {

  if 道具类型=="itemA"
   {

      if reference3=="HP全回复"||reference3=="战斗不能解除"
      {
       "小缘对兔子使用了%(道具名称),HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         itemAnum[道具代码]-=1
      }



     elseif hp1+效果数值>=hpmax1
      {
        "小缘对兔子使用了%(道具名称),HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         itemAnum[道具代码]-=1
      }

     elseif hp1+效果数值<hpmax1
      {
         hp1+=效果数值
         "小缘对兔子使用了%(道具名称),HP回复%(效果数值)\x"
         itemAnum[道具代码]-=1
      }
    }
  elseif 道具类型=="itemB"
  {

      if reference3=="EP全回复"
      {
       "小缘对兔子使用了%(道具名称),EP回复%(epmax1-ep1)\x"
         ep1=epmax1
         itemBnum[道具代码]-=1
      }

     elseif ep1+效果数值>=epmax1
      {
        "小缘对兔子使用了%(道具名称),EP回复%(epmax1-ep1)\x"
         ep1=epmax1
         itemBnum[道具代码]-=1
      }

     elseif ep1+效果数值<epmax1
      {
         ep1+=效果数值
         "小缘对兔子使用了%(道具名称),EP回复%(效果数值)\x"
         itemBnum[道具代码]-=1
      }
    }


elseif hp1==0
{
  if 道具类型=="itemA"
   {

      if reference3=="战斗不能解除"
      {
       "小缘对兔子使用了%(道具名称),兔子恢复战斗能力，并且HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         itemAnum[道具代码]-=1
      }
   }
}
--
   if hp0>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
 }

else
{ 
"不能对失去战斗能力兔子使用%(道具名称)\x" 

--
Onbattleselect0

 }


}


Ontowauseitem0
{
道具类型=reference0
道具代码=reference1
道具名称=reference2
效果数值=TOINT(reference3)

if hp0>0
{

  if 道具类型=="itemA"
   {

      if reference3=="HP全回复"||reference3=="战斗不能解除"
      {
       "兔子对小缘使用了%(道具名称),HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         itemAnum[道具代码]-=1
      }


     elseif hp0+效果数值>=hpmax0
      {
        "兔子对小缘使用了%(道具名称),HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         itemAnum[道具代码]-=1
      }

     elseif hp0+效果数值<hpmax0
      {
         hp0+=效果数值
         "兔子对小缘使用了%(道具名称),HP回复%(效果数值)\x"
         itemAnum[道具代码]-=1
      }
    }
  elseif 道具类型=="itemB"
  {


      if reference3=="EP全回复"
      {
       "兔子对小缘使用了%(道具名称),EP回复%(epmax0-ep0)\x"
         ep0=epmax0
         itemBnum[道具代码]-=1
      }
     elseif ep0+效果数值>=epmax0
      {
        "兔子对小缘使用了%(道具名称),EP回复%(epmax0-ep0)\x"
         ep0=epmax0
         itemBnum[道具代码]-=1
      }

     elseif ep0+效果数值<epmax0
      {
         ep0+=效果数值
         "兔子对小缘使用了%(道具名称),EP回复%(效果数值)\x"
         itemBnum[道具代码]-=1
      }
    }


--
	怪物反击

  }

elseif hp0==0
{
  if 道具类型=="itemA"
   {

      if reference3=="战斗不能解除"
      {
       "兔子对小缘使用了%(道具名称),小缘恢复战斗能力，并且HP回复%(hpmax0-hp0)\x"
         hp0=hpmax0
         itemAnum[道具代码]-=1
      }
   }

--
	怪物反击

}


else
{ 
"不能对失去战斗能力小缘使用%(道具名称)\x" 

--
Onbattleselect1

 }


}


Ontowauseitem1
{
道具类型=reference0
道具代码=reference1
道具名称=reference2
效果数值=TOINT(reference3)

  if 道具类型=="itemA"
   {

     if reference3=="HP全回复"||reference3=="战斗不能解除"
      {
       "兔子对自己使用了%(道具名称),HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         itemAnum[道具代码]-=1
      }



     elseif hp1+效果数值>=hpmax1
      {
        "兔子对自己使用了%(道具名称),HP回复%(hpmax1-hp1)\x"
         hp1=hpmax1
         itemAnum[道具代码]-=1
      }

     elseif hp1+效果数值<hpmax1
      {
         hp1+=效果数值
         "兔子对自己使用了%(道具名称),HP回复%(效果数值)\x"
         itemAnum[道具代码]-=1
      }
    }
  elseif 道具类型=="itemB"
  {
     if reference3=="EP全回复"
      {
       "兔子对自己使用了%(道具名称),EP回复%(epmax1-ep1)\x"
         ep1=epmax1
         itemBnum[道具代码]-=1
      }

     elseif ep1+效果数值>=epmax1
      {
        "兔子对自己使用了%(道具名称),EP回复%(epmax1-ep1)\x"
         ep1=epmax1
         itemBnum[道具代码]-=1
      }

     elseif ep1+效果数值<epmax1
      {
         ep1+=效果数值
         "兔子对自己使用了%(道具名称),EP回复%(效果数值)\x"
         itemBnum[道具代码]-=1
      }
    }

--
	
     怪物反击
}


超出反应
{
信息参数
--


_weapon = (weaponA,weaponB)
_armor = (armorA,armorB)
_boots = (bootsA,bootsB)
 foreach _weapon; _i {
                     if _i[3]==0 && weaponID0==_i[1] && weaponsort0==_i[0]
                                                 {
                                                
                                                weaponID0=NULL
                                                weapon0=NULL
                                                 weaponequip_str0=0
                                               
                                                 }


                    
                     if _i[3]==0 && weaponID1==_i[1] && weaponsort1==_i[0]
                                                 {
   
                                                 weaponID1=NULL
                                                 weapon1=NULL
                                                 weaponequip_str1=0
                                               
                                                 }

                      if _i[3]==1 && weaponID0==_i[1] && weaponsort0==_i[0] && weaponID1==_i[1] && weaponsort1==_i[0] 
                                                {

                                                 weaponID1=NULL
                                                 weapon1=NULL
                                                 weaponequip_str1=0 
                                                 
                                                 }

                 }


              
  foreach _armor; _i {

                     if _i[3]==0 && armorID0==_i[1] && armorsort0==_i[0]
                                                 {
                                                
                                                armorID0=NULL
                                                armor0=NULL
                                                 armorequip_def0=0
                                               armorequip_adf0=0
                                               
                                                 }


                    
                     if _i[3]==0 && armorID1==_i[1] && armorsort1==_i[0]
                                                 {
                                                  armorID1=NULL
                                                  armor1=NULL
                                                  armorequip_def1=0
                                                  armorequip_adf1=0 
                                                   
                                                 }
           
                         if _i[3]==1 && armorID0==_i[1] && armorsort0==_i[0] && armorID1==_i[1] && armorsort1==_i[0] 
                                                {
                                                  armorID1=NULL
                                                  armor1=NULL
                                                  armorequip_def1=0
                                                  armorequip_adf1=0 
                                                
                                                }
                 }

   foreach _boots; _i {
                    if _i[3]==0 && bootsID0==_i[1] && bootssort0==_i[0]
                                                 {
                                                
                                                bootsID0=NULL
                                                boots0=NULL
                                                 bootsequip_def0=0
                                               bootsequip_adf0=0
                                                
                                                 }


                    
                     if _i[3]==0 && bootsID1==_i[1] && bootssort1==_i[0]
                                                 {
                                                  bootsID1=NULL
                                                  boots1=NULL
                                                  bootsequip_def1=0
                                                  bootsequip_adf1=0 
                                                  
                                                 }

                      if _i[3]==1 && bootsID0==_i[1] && bootssort0==_i[0] && bootsID1==_i[1] && bootssort1==_i[0] 
                                                {
                                                  bootsID1=NULL
                                                  boots1=NULL
                                                  bootsequip_def1=0
                                                  bootsequip_adf1=0 
                                              
                                                }
                 }

}

kikkashopMenu
{
信息参数
--


	if shopMenu == 0{
		"\n" + ColorText("\__q[OnshopMenu,1]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────武器店↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
               weaponshop
 

	}
	elseif shopMenu == 1 {
		"\n" + ColorText("\__q[OnshopMenu,2]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────防具店↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
		armorshop;
	}

        elseif shopMenu == 2 

          {
		"\n" + ColorText("\__q[OnshopMenu,3]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────道具店↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
		itemshop;
	}


         elseif shopMenu == 3

          {
		"\n" + ColorText("\__q[OnshopMenu,0]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────旅店↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
		hotel;
	}


}




OnshopMenu
{
	shopMenu = reference0;
	OpenRpgGameMenu(4);
}



weaponshop
{


if weaponshopmode == 0{
		"\n" + ColorText("\__q[Onweaponshopmode,1]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────购买↓──────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
               weaponbuy
 
                      }



elseif weaponshopmode == 1{
		"\n" + ColorText("\__q[Onweaponshopmode,0]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────卖出↓──────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
               weaponsell
 
                      }

}


armorshop
{


if armorshopmode == 0{
		"\n" + ColorText("\__q[Onarmorshopmode,1]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────购买↓──────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
               armorbuy
 
                      }



elseif armorshopmode == 1{
		"\n" + ColorText("\__q[Onarmorshopmode,0]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────卖出↓──────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
               armorsell
 
                      }

}


itemshop
{


if itemshopmode == 0{
		"\n" + ColorText("\__q[Onitemshopmode,1]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────购买↓──────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
               itembuy
 
                      }



elseif itemshopmode == 1{
		"\n" + ColorText("\__q[Onitemshopmode,0]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────卖出↓──────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q","color=160,160,200");
		--
               itemsell
 
                      }

}


hotel
{
"\n\q[住宿,Onlodging]\n/
\q[换金,Onchangemoney]"

}

Onlodging
{
"确定花%(100+5*(lvl0-1))金住宿？\n/
\q[是,Onyeslodging]\n/
\q[否,Onnotlodging]"
}


Onyeslodging
{
"小缘和兔子休息了一晚上,体力和精力全恢复了\x"
hp0=hpmax0
ep0=epmax0
hp1=hpmax1
ep1=epmax1

--
OpenRpgGameMenu(4)
}


Onnotlodging
{
OpenRpgGameMenu(4)
}


Onchangemoney
{

"换金服务能把小缘游戏币换为小缘养成币，确定更换？\n/
\q[是,Onyeschange]\n/
\q[否,Onnotchange]"


}

Onyeschange
{
   if reference0==NULL
   {
   "请输入金额。\![open,inputbox,Onyeschange]"
   }
   elseif reference0>0
   {
   money-=TOINT(reference0)
   kikkamoney+=TOINT(reference0)
   "换金成功\x"

    --
    	OpenRpgGameMenu(4)

   }

   else
    {
     "请输入大于0的数字。\![open,inputbox,Onyeschange]"


    }

}

Onnotchange
{

OpenRpgGameMenu(4)


}



Onweaponshopmode
{
	weaponshopmode = reference0;
	OpenRpgGameMenu(4);
}

Onarmorshopmode
{
	armorshopmode = reference0;
	OpenRpgGameMenu(4);
}

Onitemshopmode
{
	itemshopmode = reference0;
	OpenRpgGameMenu(4);
}


Onmissionclass
{
	missionclass = reference0;
	OpenRpgGameMenu(5);
}


weaponbuy
{

_txt="\n"

_txt+="\_l[0,-]名称    \_l[65,-]STR   \_l[110,-]ATS   \_l[155,-]购买价格   \_l[210,-]已有数量\n     "
foreach weaponA; _i {
                        if lvl>=TOINT(_i[4]-10)

                             {
      _txt += "\_l[0,-]%(_i[2]) \_l[65,-]%(_i[6])   \_l[110,-]%(_i[7])  \_l[155,-]%(_i[5])  \_l[210,-]%(_i[3]) \_l[260,-] \q[购买,Onbuy,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[5])]\n"
                              }

   
		    }



_txt

}





weaponsell
{
_txt="\n"




_txt+="\_l[0,-]名称    \_l[65,-]STR    \_l[110,-]ATS   \_l[155,-]卖出价格   \_l[210,-]已有数量\n     "
foreach weaponA; _i {
                       if _i[3] > 0
                              {
      _txt += "\_l[0,-]%(_i[2]) \_l[65,-]%(_i[6])  \_l[110,-]%(_i[7])  \_l[155,-]%(TOINT(0.6*_i[5]))  \_l[210,-]%(_i[3]) \_l[260,-] \q[卖出,Onsellnum,%(_i[0]),%(_i[1]),%(_i[2]),%(TOINT(0.6*_i[5]))]\n"
                              }
          
		    }

foreach weaponB; _i {
                       if _i[3] > 0
                              {
      _txt += "\_l[0,-]%(_i[2]) \_l[65,-]%(_i[6])  \_l[110,-]%(_i[7])  \_l[155,-]%(TOINT(0.6*_i[5]))  \_l[210,-]%(_i[3]) \_l[260,-] \q[卖出,Onsellnum,%(_i[0]),%(_i[1]),%(_i[2]),%(TOINT(0.6*_i[5]))]\n"
                              }
          
		    }


_txt



}


armorbuy
{
_txt="\n"

_txt+="\_l[0,-]名称    \_l[65,-]DEF    \_l[95,-]ADF  \_l[120,-]STR  \_l[145,-]ATS \_l[170,-]购买价格   \_l[220,-]已有数量\n"

_txt+="──────────防具（体）─────────\n"
       foreach armorA; _i 
                            {
                           if lvl>=TOINT(_i[4]-15)
                                      {
      _txt += "\_l[0,-]%(_i[2]) \_l[65,-]%(_i[6])  \_l[95,-]%(_i[7])  \_l[120,-]%(_i[8])  \_l[145,-]%(_i[9])  \_l[170,-]%(_i[5])  \_l[220,-]%(_i[3]) \_l[260,-] \q[购买,Onbuy,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[5])]\n"
                                       }
		            }


_txt+="──────────防具（脚）─────────\n"

        foreach bootsA; _i 
                            {
                          if lvl>=TOINT(_i[4]-20)
                                     {
      _txt += "\_l[0,-]%(_i[2]) \_l[65,-]%(_i[6])  \_l[95,-]%(_i[7])  \_l[120,-]%(_i[8])  \_l[145,-]%(_i[9])    \_l[170,-]%(_i[5])  \_l[220,-]%(_i[3]) \_l[260,-] \q[购买,Onbuy,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[5])]\n"
                                     }
		            }

_txt

}


armorsell
{
_txt="\n"




_txt+="\_l[0,-]名称    \_l[65,-]DEF    \_l[95,-]ADF  \_l[120,-]STR  \_l[145,-]ATS \_l[170,-]卖出价格   \_l[220,-]已有数量\n"
_txt+="──────────防具（体）─────────\n"
foreach armorA; _i {
                       if _i[3] > 0
                              {
      _txt += "\_l[0,-]%(_i[2]) \_l[65,-]%(_i[6])  \_l[95,-]%(_i[7])  \_l[120,-]%(_i[8])  \_l[145,-]%(_i[9])   \_l[170,-]%(TOINT(0.6*_i[5]))  \_l[220,-]%(_i[3]) \_l[260,-] \q[卖出,Onsellnum,%(_i[0]),%(_i[1]),%(_i[2]),%(TOINT(0.6*_i[5]))]\n"
                              }
          
		    }

foreach armorB; _i {
                       if _i[3] > 0
                              {
      _txt += "\_l[0,-]%(_i[2]) \_l[65,-]%(_i[6])  \_l[95,-]%(_i[7])  \_l[120,-]%(_i[8])  \_l[145,-]%(_i[9]) \_l[170,-]%(TOINT(0.6*_i[5]))  \_l[220,-]%(_i[3]) \_l[260,-] \q[卖出,Onsellnum,%(_i[0]),%(_i[1]),%(_i[2]),%(TOINT(0.6*_i[5]))]\n"
                              }
          
		    }


_txt+="──────────防具（脚）─────────\n"
foreach bootsA; _i {
                       if _i[3] > 0
                              {
      _txt += "\_l[0,-]%(_i[2]) \_l[65,-]%(_i[6])  \_l[95,-]%(_i[7])  \_l[120,-]%(_i[8])  \_l[145,-]%(_i[9]) \_l[170,-]%(TOINT(0.6*_i[5]))  \_l[220,-]%(_i[3]) \_l[260,-] \q[卖出,Onsellnum,%(_i[0]),%(_i[1]),%(_i[2]),%(TOINT(0.6*_i[5]))]\n"
                              }
          
		    }

foreach bootsB; _i {
                       if _i[3] > 0
                              {
      _txt += "\_l[0,-]%(_i[2]) \_l[65,-]%(_i[6])  \_l[95,-]%(_i[7])  \_l[120,-]%(_i[8])  \_l[145,-]%(_i[9]) \_l[170,-]%(TOINT(0.6*_i[5]))  \_l[220,-]%(_i[3]) \_l[260,-] \q[卖出,Onsellnum,%(_i[0]),%(_i[1]),%(_i[2]),%(TOINT(0.6*_i[5]))]\n"
                              }
          
		    }

_txt



}



itembuy
{

_txt="\n"

_txt+="\_l[0,-]名称    \_l[80,-]效果    \_l[160,-]购买价格   \_l[220,-]已有数量\n     "
foreach itemA; _i {
                       
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[160,-]%(_i[4])  \_l[220,-]%(_i[3]) \_l[260,-] \q[购买,Onitembuynum,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[4])]\n"
                 

   
		            }

foreach itemB; _i {
                       
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[160,-]%(_i[4])  \_l[220,-]%(_i[3]) \_l[260,-] \q[购买,Onitembuynum,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[4])]\n"
                 

   
		            }

_txt

}



itemsell
{

_txt="\n"

_txt+="\_l[0,-]名称    \_l[65,-]效果    \_l[160,-]卖出价格   \_l[220,-]已有数量\n     "
foreach itemA; _i {
                       if _i[3] > 0
                             {
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[160,-]%(TOINT(0.6*_i[4]))  \_l[220,-]%(_i[3]) \_l[260,-] \q[卖出,Onsellnum,%(_i[0]),%(_i[1]),%(_i[2]),%(TOINT(0.6*_i[4]))]\n"
                 
                              }
		 }

foreach itemB; _i {
                       if _i[3] > 0
                             {
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[160,-]%(TOINT(0.6*_i[4]))  \_l[220,-]%(_i[3]) \_l[260,-] \q[卖出,Onsellnum,%(_i[0]),%(_i[1]),%(_i[2]),%(TOINT(0.6*_i[4]))]\n"
                 
                            }
 
		  }

_txt




}


Onbuy
{

       if  reference4==NULL && reference5==NULL
          {
"\0\s[40]确定花%(reference3)购买%(reference2)？\n/
\q[◇是,Onbuy,%(reference0),%(reference1),%(reference2),%(reference3),＆,1]\n/
\q[◇否,Onbuy,%(reference0),%(reference1),%(reference2),%(reference3),＆,0]"
         }
       if reference4=="＆" && reference5==1
         {

             
         if money>=TOINT(reference3)
              {      

              if reference0=="weaponA"
                {
             weaponAnum[reference1]+=1
             money-=TOINT(reference3)
             "\0\s[5]购买成功,花费%(TOINT(reference3))金\x"
              --
             OpenRpgGameMenu(4);
                }

            elseif reference0=="armorA"
                {
                armorAnum[reference1]+=1
                money-=TOINT(reference3)
               "\0\s[5]购买成功,花费%(TOINT(reference3))金\x"
              --
                OpenRpgGameMenu(4);
                 }
            elseif reference0=="bootsA"
                {
                bootsAnum[reference1]+=1
                money-=TOINT(reference3)
                "\0\s[5]购买成功,花费%(TOINT(reference3))金\x"
              --
                OpenRpgGameMenu(4);
                 }
             }

           else 
            {
             "金钱不足，购买失败\x"
              --
                OpenRpgGameMenu(4);
            }
           



        }

         elseif reference4=="＆" && reference5==0
        {
             OpenRpgGameMenu(4);
        }
    

}




Onsellnum
{
物品种类=reference0
物品代码=reference1
物品名称=reference2
物品价格=reference3


"请输入卖出数量\n\![open,inputbox,Onsell]\n/
\n\n\q[取消,cancelshop]"


}


Select.cancelshop
{

OpenRpgGameMenu(4)


}

Onsell
{      
if reference0<=0
{
"请输入大于0的数字\![open,inputbox,Onsell]"



}

else
{

       卖出数量=reference0
       if  reference5==NULL && reference6==NULL
          {
"确定以%(物品价格)的单价卖出%(卖出数量)件%(物品名称)？\n/
\q[◇是,Onsell,%(卖出数量),%(物品种类),%(物品代码),%(物品名称),%(物品价格),＆,1]\n/
\q[◇否,Onsell,%(卖出数量),%(物品种类),%(物品代码),%(物品名称),%(物品价格),＆,0]"
         }
       if reference5=="＆" && reference6==1
         {
              

            if reference1=="weaponA" 
                {
                    

                  if weaponAnum[reference2]>=卖出数量
                    { 
                     weaponAnum[reference2]-=卖出数量
                       "卖出成功,得到%(TOINT(物品价格*卖出数量))金\x"
                      money+=TOINT(物品价格*卖出数量)
                         --
                     OpenRpgGameMenu(4);
                    }
                  
                  else 
                    {

                   "数量不足,卖出失败\x"
                 --
                OpenRpgGameMenu(4)
                    }

                 }

            elseif reference1=="weaponB"
                {
                   if weaponBnum[reference2]>=卖出数量
                    {
                weaponBnum[reference2]-=卖出数量
                   "卖出成功,得到%(TOINT(物品价格*卖出数量))金\x"
                    money+=TOINT(物品价格*卖出数量)
                      --
                OpenRpgGameMenu(4);
                    }

                else 
                    {
                   "数量不足,卖出失败\x"
                 --
                OpenRpgGameMenu(4)
                    }


                 }

 
              if reference1=="armorA"
                {
                  if armorAnum[reference2]>=卖出数量
                    { 
                     armorAnum[reference2]-=卖出数量
                       "卖出成功,得到%(TOINT(物品价格*卖出数量))金\x"
                      money+=TOINT(物品价格*卖出数量)
                         --
                     OpenRpgGameMenu(4);
                    }
                  
                  else 
                    {

                   "数量不足,卖出失败\x"
                 --
                OpenRpgGameMenu(4)
                    }

                 }

            elseif reference1=="armorB"
                {
                   if armorBnum[reference2]>=卖出数量
                    {
                armorBnum[reference2]-=卖出数量
                   "卖出成功,得到%(TOINT(物品价格*卖出数量))金\x"
                    money+=TOINT(物品价格*卖出数量)
                        --
                OpenRpgGameMenu(4);
                    }

                else 
                    {
                   "数量不足,卖出失败\x"
                 --
                OpenRpgGameMenu(4)
                    }


                 }

           elseif reference1=="bootsA"
                {
                   if bootsAnum[reference2]>=卖出数量
                    {
                bootsAnum[reference2]-=卖出数量
                   "卖出成功,得到%(TOINT(物品价格*卖出数量))金\x"
                    money+=TOINT(物品价格*卖出数量)
                       --
                OpenRpgGameMenu(4);
                    }

                else 
                    {
                   "数量不足,卖出失败\x"
                 --
                OpenRpgGameMenu(4)
                    }


                 }


            elseif reference1=="bootsB"
                {
                   if bootsBnum[reference2]>=卖出数量
                    {
                bootsBnum[reference2]-=卖出数量
                   "卖出成功,得到%(TOINT(物品价格*卖出数量))金\x"
                    money+=TOINT(物品价格*卖出数量)
                        --
                OpenRpgGameMenu(4);
                    }

                else 
                    {
                   "数量不足,卖出失败\x"
                 --
                OpenRpgGameMenu(4)
                    }

               }

           elseif reference1=="itemA"
                {
                  if itemAnum[reference2]>=卖出数量
                    { 
                     itemAnum[reference2]-=卖出数量
                       "卖出成功,得到%(TOINT(物品价格*卖出数量))金\x"
                      money+=TOINT(物品价格*卖出数量)
                         --
                     OpenRpgGameMenu(4);
                    }
                  
                  else 
                    {

                   "数量不足,卖出失败\x"
                 --
                OpenRpgGameMenu(4)
                    }

                 }

            elseif reference1=="itemB"
                {
                   if itemBnum[reference2]>=卖出数量
                    {
                itemBnum[reference2]-=卖出数量
                   "卖出成功,得到%(TOINT(物品价格*卖出数量))金\x"
                    money+=TOINT(物品价格*卖出数量)
                       --
                OpenRpgGameMenu(4);
                    }

                else 
                    {
                   "数量不足,卖出失败\x"
                 --
                OpenRpgGameMenu(4)
                    }


                 }


       }
              

         elseif reference4=="＆" && reference5==0
        {
             OpenRpgGameMenu(4);
        }
    
}
}




Onitembuynum
{
道具种类=reference0
道具代码=reference1
道具名称=reference2
道具价格=reference3


"\0\s[40]请输入购买数量\n\![open,inputbox,Onitembuy]\n/
\n\n\q[取消,cancelshop]"

}






Onitembuy
{
   if reference0<=0
    {
     "\0\s[40]请输入大于0的数字\![open,inputbox,Onsell]"



    }

  else
   {



购买数量=reference0
       if  reference5==NULL && reference6==NULL
        {     
      "确定以%(道具价格)的单价购买%(购买数量)件%(道具名称)？\n/
\q[◇是,Onitembuy,%(购买数量),%(道具种类),%(道具代码),%(道具名称),%(道具价格),＆,1]\n/
\q[◇否,Onitembuy,%(购买数量),%(道具种类),%(道具代码),%(道具名称),%(道具价格),＆,0]"
         }
       if reference5=="＆" && reference6==1
         {
            
            if reference1=="itemA"
                {
                itemAnum[reference2]+=购买数量
                "购买成功,花费%(道具价格*购买数量)金\x"
                 --
                OpenRpgGameMenu(4);
                 }
            elseif reference1=="itemB"
                {
                itemBnum[reference2]+=reference0
                "购买成功,花费%(道具价格*购买数量)金\x"
                 --
                OpenRpgGameMenu(4);
                 }
             
            
          }

         elseif reference5=="＆" && reference6==0
        {
             OpenRpgGameMenu(4);
        }
  }  
}





mission
{

RpgGameVar
if hp0==0
     {
      hp0=TOINT(0.1*hpmax0)
     }

   if hp1==0
     {
     hp1=TOINT(0.1*hpmax1)
     }

     if missionclass == 0{
		"\n" + ColorText("\__q[Onmissionclass,1]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────D级任务↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q\n","color=160,160,200");
		--
               missionclassD
 
                      }



elseif missionclass == 1{
		"\n" + ColorText("\__q[Onmissionclass,2]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────C级任务↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q\n","color=160,160,200");
		--
               missionclassC
 
                      }


elseif missionclass == 2{
		"\n" + ColorText("\__q[Onmissionclass,3]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────B级任务↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q\n","color=160,160,200");
		--
               missionclassB
 
                      }

elseif missionclass == 3{
		"\n" + ColorText("\__q[Onmissionclass,0]\f[cursorstyle,none]\f[cursorfontcolor,65,203,214]───────────A级任务↓─────────\f[cursorstyle,default]\f[cursorfontcolor,default]\__q\n","color=160,160,200");
		--
               missionclassA
 
                      }


--
battlenum=victorynum+battlefailednum+escapenum
"\_l[-,250]\n履历：\n/
战斗次数：     %(battlenum)\n/
战斗胜利次数： %(victorynum)（%(100.0*victorynum/battlenum)%）\n/
战斗不能次数： %(losehpnum)\n/
战斗失败次数： %(battlefailednum)（%(100.0*battlefailednum/battlenum)%）\n/
逃跑次数：     %(escapenum)（%(100.0*escapenum/battlenum)%）          \_l[240,-]\q[退出游戏,Onesc]"


}






missionclassD
{

"\q[领取奖励,Onaward]\n/
\__q[Onmission,D,1]在农场消灭10只怪物，赏金%(TOINT(20*lvl))\__q   \n/
 \__q[Onmission,D,1.1]在平原消灭10只怪物，赏金%(TOINT(1.1*20*lvl))\__q   \n/
\__q[Onmission,D,1.2]在山地消灭10只怪物，赏金%(TOINT(1.2*20*lvl))\__q   \n/
\__q[Onmission,D,1.3]在河谷消灭10只怪物，赏金%(TOINT(1.3*20*lvl))\__q   \n/
\__q[Onmission,D,1.4]在山谷消灭10只怪物，赏金%(TOINT(1.4*20*lvl))\__q   \n/
\__q[Onmission,D,1.5]在湿地消灭10只怪物，赏金%(TOINT(1.5*20*lvl))\__q   \n/
\__q[Onmission,D,1.6]在地下封印区入口消灭10只怪物，赏金%(TOINT(1.6*20*lvl))\__q   \n/
\__q[Onmission,D,1.7]在地下封印区上层消灭10只怪物，赏金%(TOINT(1.7*20*lvl))\__q   \n/
\__q[Onmission,D,1.8]在地下封印区中层消灭10只怪物，赏金%(TOINT(1.8*20*lvl))\__q   \n/
\__q[Onmission,D,1.9]在地下封印区下层消灭10只怪物，赏金%(TOINT(1.9*20*lvl))\__q   \n/
\__q[Onmission,D,2]在地下封印区核心消灭10只怪物，赏金%(TOINT(2*20*lvl))/%(TOINT(8*20*lvl))\__q   \n/
"
}

missionclassC
{

"\q[领取奖励,Onaward]\n/
\__q[Onmission,C,1]在农场消灭10只怪物，赏金%(TOINT(2*20*lvl))\__q  \n/
\__q[Onmission,C,1.1]在平原消灭10只怪物，赏金%(TOINT(2*1.1*20*lvl))\__q   \n/
\__q[Onmission,C,1.2]在山地消灭10只怪物，赏金%(TOINT(2*1.2*20*lvl))\__q   \n/
\__q[Onmission,C,1.3]在河谷消灭10只怪物，赏金%(TOINT(2*1.3*20*lvl))\__q   \n/
\__q[Onmission,C,1.4]在山谷消灭10只怪物，赏金%(TOINT(2*1.4*20*lvl))\__q   \n/
\__q[Onmission,C,1.5]在湿地消灭10只怪物，赏金%(TOINT(2*1.5*20*lvl))\__q   \n/
\__q[Onmission,C,1.6]在地下封印区入口消灭10只怪物，赏金%(TOINT(2*1.6*20*lvl))\__q   \n/
\__q[Onmission,C,1.7]在地下封印区上层消灭10只怪物，赏金%(TOINT(2*1.7*20*lvl))\__q   \n/
\__q[Onmission,C,1.8]在地下封印区中层消灭10只怪物，赏金%(TOINT(2*1.8*20*lvl))\__q   \n/
\__q[Onmission,C,1.9]在地下封印区下层消灭10只怪物，赏金%(TOINT(2*1.9*20*lvl))\__q   \n/
\__q[Onmission,C,2]在地下封印区核心消灭10只怪物，赏金%(TOINT(2*2*20*lvl))/%(TOINT(2*8*20*lvl))\__q   \n/
"
}



missionclassB
{

"\q[领取奖励,Onaward]\n/
\__q[Onmission,B,1]在农场消灭10只怪物，赏金%(TOINT(3*20*lvl))\__q   \n/
\__q[Onmission,B,1.1]在平原消灭10只怪物，赏金%(TOINT(3*1.1*20*lvl))\__q   \n/
\__q[Onmission,B,1.2]在山地消灭10只怪物，赏金%(TOINT(3*1.2*20*lvl))\__q   \n/
\__q[Onmission,B,1.3]在河谷消灭10只怪物，赏金%(TOINT(3*1.3*20*lvl))\__q   \n/
\__q[Onmission,B,1.4]在山谷消灭10只怪物，赏金%(TOINT(3*1.4*20*lvl))\__q   \n/
\__q[Onmission,B,1.5]在湿地消灭10只怪物，赏金%(TOINT(3*1.5*20*lvl))\__q   \n/
\__q[Onmission,B,1.6]在地下封印区入口消灭10只怪物，赏金%(TOINT(3*1.6*20*lvl))\__q   \n/
\__q[Onmission,B,1.7]在地下封印区上层消灭10只怪物，赏金%(TOINT(3*1.7*20*lvl))\__q   \n/
\__q[Onmission,B,1.8]在地下封印区中层消灭10只怪物，赏金%(TOINT(3*1.8*20*lvl))\__q   \n/
\__q[Onmission,B,1.9]在地下封印区下层消灭10只怪物，赏金%(TOINT(3*1.9*20*lvl))\__q   \n/
\__q[Onmission,B,2]在地下封印区核心消灭10只怪物，赏金%(TOINT(3*2*20*lvl))/%(TOINT(3*8*20*lvl))\__q   \n/
"
}



missionclassA
{

"\q[领取奖励,Onaward]\n/
\__q[Onmission,A,1]在农场消灭10只怪物，赏金%(TOINT(4*20*lvl))\__q   \n/
\__q[Onmission,A,1.1]在平原消灭10只怪物，赏金%(TOINT(4*1.1*20*lvl))\__q   \n/
\__q[Onmission,A,1.2]在山地消灭10只怪物，赏金%(TOINT(4*1.2*20*lvl))\__q   \n/
\__q[Onmission,A,1.3]在河谷消灭10只怪物，赏金%(TOINT(4*1.3*20*lvl))\__q   \n/
\__q[Onmission,A,1.4]在山谷消灭10只怪物，赏金%(TOINT(4*1.4*20*lvl))\__q   \n/
\__q[Onmission,A,1.5]在湿地消灭10只怪物，赏金%(TOINT(4*1.5*20*lvl))\__q   \n/
\__q[Onmission,A,1.6]在地下封印区入口消灭10只怪物，赏金%(TOINT(4*1.6*20*lvl))\__q   \n/
\__q[Onmission,A,1.7]在地下封印区上层消灭10只怪物，赏金%(TOINT(4*1.7*20*lvl))\__q   \n/
\__q[Onmission,A,1.8]在地下封印区中层消灭10只怪物，赏金%(TOINT(4*1.8*20*lvl))\__q   \n/
\__q[Onmission,A,1.9]在地下封印区下层消灭10只怪物，赏金%(TOINT(4*1.9*20*lvl))\__q   \n/
\__q[Onmission,A,2]在地下封印区核心消灭10只怪物，赏金%(TOINT(4*2*20*lvl))/%(TOINT(4*8*20*lvl))\__q   \n/
"
}


Onaward
{

    if award==1 && class=="D"
      {
     money+=level*20*lvl
      "已领取D级任务奖励，得到%(TOINT(level*20*lvl))金\x"
     
      award=0

      --
     OpenRpgGameMenu(5)
      }


     elseif award==1 && class=="C"
      {
     money+=2*level*20*lvl
      "已领取C级任务奖励，得到%(TOINT(level*2*20*lvl))金\x"
      award=0
      --
     OpenRpgGameMenu(5)
      }


     
     elseif award==1 && class=="B"
      {
     money+=3*level*20*lvl
      "已领取B级任务奖励，得到%(TOINT(level*3*20*lvl))金\x"
      award=0
      --
     OpenRpgGameMenu(5)
      }

     
     elseif award==1 && class=="A"
      {
     money+=4*level*20*lvl
      "已领取A级任务奖励，得到%(TOINT(level*4*20*lvl))金\x"
     award=0
      --
     OpenRpgGameMenu(5)
      }

     else
      {
      "未达到奖励条件，领取失败\x"
      --
     OpenRpgGameMenu(5)
      }


}

Onmission
{
class=reference0
level=reference1
RpgGameVar
mnum=0
award=0
if level==1
  {
"小缘和兔子来到了农场\x"
  }

elseif level==1.1
{
"小缘和兔子来到了平原\x"
  }

elseif level==1.2
{
"小缘和兔子来到了山地\x"
}

elseif level==1.3
{
"小缘和兔子来到了河谷\x"
}

elseif level==1.4
{
"小缘和兔子来到了山谷\x"
}

elseif level==1.5
{
"小缘和兔子来到了湿地\x"
}

elseif level==1.6
{
"小缘和兔子来到了地下封印区入口\x"
}

elseif level==1.7
{
"小缘和兔子来到了在地下封印区上层\x"
}

elseif level==1.8
{
"小缘和兔子来到了地下封印区中层\x"
}

elseif level==1.9
{
"小缘和兔子来到了地下封印区下层\x"
}

elseif level==2
{
"小缘和兔子来到了地下封印区核心\x"

}

--
Onbattle

}

Onbattle
{
 

f=RAND(100)
      if f>15 && f<=50
      {
    "什么也没发现。\n/
      \q[继续逛,Onbattle]\n/
      \q[休息一下,On休息]\n/
      \q[回去吧,back]"
      }
      elseif f>5 && f<=15
       {
       i=RAND(9)
        if i<5
             {
      "发现%(itemA[(mlv/18)%5][2])\n/
        \q[继续逛,Onbattle]\n/
        \q[休息一下,On休息]\n/
        \q[回去吧,back]"
              itemAnum[(mlv/18)%5]+=1

              }
             
        elseif i>=5
             {
      "发现%(itemB[(mlv/18)%5][2])\n/
         \q[继续逛,Onbattle]\n/
         \q[休息一下,On休息]\n/
         \q[回去吧,back]"
              itemBnum[(mlv/18)%5]+=1
             }
       }
      

      elseif f<=5
      {
    "发现%(5*mlv)金\n/
       \q[继续逛,Onbattle]\n/
       \q[休息一下,On休息]\n/
       \q[回去吧,back]"
       money+=5*mlv
      }

      elseif f>50
      {
          if mnum<9
           {
           怪物名字=monster
        "发现%(怪物名字),进入战斗\x"
         --
        Onbattleinter
           }

              elseif mnum==9
             {
             b=RAND(2)
                  if b==0
                  {
           怪物名字=monster
            "发现%(怪物名字),进入战斗\x"
            --
        Onbattleinter
                  }
                 elseif b==1 && level==2
                 {
            怪物名字="幻想乐曲复合体"
               "发现终级BOSS：%(怪物名字),要退却吗？\n/
                \q[退却,Onbattle]\n/
                \q[迎战,Onbossfight]"
                 }
             }

      
      }


}

Onbattleinter
{
               if class=="D" 
                 {  
                    怪物魔防=-2
                    mlvx=RAND(3)
                    RpgGameVar
                          
              battleDbegin(level*mhpmaxD,mstrD,mdefD,matsD,madfD,1)
                 }

          elseif class=="C"
               {  
                    怪物魔防=-1
                    mlvx=RAND(6)
                    RpgGameVar
                   
              battleDbegin(level*mhpmaxC,mstrC,mdefC,matsC,madfC,2)
                 }

          elseif class=="B"
                 { 
                   怪物魔防=0
                   mlvx=RAND(9)
                   RpgGameVar
              battleDbegin(level*mhpmaxB,mstrB,mdefB,matsB,madfB,3)
                 }
          elseif class=="A"
                 {怪物魔防=1
                  mlvx=RAND(12)
                  RpgGameVar             
              battleDbegin(level*mhpmaxA,mstrA,mdefA,matsA,madfA,4)
                 }
}

Onbossfight
{
  level=8
--
 Onbattleinter

}

monster
{
  if level==1
   {
   "黄鼠狼怪"
   "田鼠怪"
   "菠萝怪"
   }


   elseif level==1.1
   {
   "野猪怪"
   "黑熊怪"
   "大蜥蜴"
   }

  elseif level==1.2
   {
   "野狼怪"
   "剑齿兽"
   "食人怪"
   }

  elseif level==1.3
   {
   "剪刀蟹"
   "暴躁气泡"
   "骸骨鱼"
   }

 elseif level==1.4
   {
   "剑齿吸血魔"
   "烈炎草"
   }

   elseif level==1.5
   {
   "贪婪锷鱼"
   "凶暴巨锷"
   }

    elseif level==1.6
   {
   "侦察飞行器"
   "机械守卫"
   }

    elseif level==1.7
   {
   "光子裁决"
   "高能装甲"
  
   }

   elseif level==1.8
   {
   "毁灭者D型"
   "毁灭者S型"
   "毁灭者M型"
   }

  elseif level==1.9
   {
   "守护之臂R"
   "守护之臂L"
   }


 elseif level==2
   {
   "幻想乐曲"
   "幻想乐曲II"
   "幻想乐曲III"
   }


}


battleinfo
{


if cp0>200
      { 
       cp0=200
      }
    if cp1>200
      {
       cp1=200
      }


战技0=("0,助威,辅助,复体,3,20,STR+50%","1,双管齐下,攻击,单体,15,20,-100,2","2,列波三连射,攻击,单体,20,20,-100,3","3,金刚击,攻击,单体,25,20,驱动解除,1","4,欢乐激发,回复,复体,26,20,1000","5,樱花排击炮,攻击S,单体,3,100,800,3","6,小缘排击炮,攻击S,单体,24,100,1200,3","7,双管齐下2,攻击,单体,43,20,500,2","8,列波三连射2,攻击,单体,67,20,500,3","9,真·金刚击,攻击,单体,70,20,驱动解除,3","10,欢乐激发2,回复,复体,67,20,3000","11,真·樱花排击炮,攻击S,单体,45,100,1250,4","13,真·小缘排击炮,攻击S,单体,57,100,1667,4","14,奥义·天下无双,攻击S,单体,81,100,2350,5")

战技1=("0,双连击,攻击,单体,3,20,-100,2","1,烈火取栗,攻击,单体,15,20,-100,3","2,爱的轨迹,攻击,单体,26,20,125,3","3,安魂曲,攻击S,单体,3,100,800,3","4,女王之怒,攻击S,单体,24,100,1200,3","5,真·烈火取栗,攻击,单体,43,20,500,2","6,爱的轨迹2,攻击,单体,67,20,500,3","7,真·安魂曲,攻击S,单体,45,100,1250,4","8,真·女王之怒,攻击S,单体,57,100,1667,4","9,奥义·量子风暴,攻击S,单体,81,100,2000,5")




--

"\![quicksession,true]\1\![set,choicetimeout,0]\_l[0,0]小缘%(kikka)\f[color,231,171,109] 等级\f[color,default]%(lvl0)  \f[color,231,171,109]Next\f[color,default]%(nextexp0) \_l[150,-]兔子%(towa)\f[color,231,171,109] 等级\f[color,default]%(lvl1)  \f[color,231,171,109]Next\f[color,default]%(nextexp1)\n/
         \f[color,231,171,109]HP\f[color,default]\_l[30,-]%(hp0)/%(hpmax0) %(ColorBar(6,20,hp0,hpmax0)) \_l[150,-]\f[color,231,171,109]HP\f[color,default]\_l[180,-]%(hp1)/%(hpmax1) %(ColorBar(6,170,hp1,hpmax1))\n/    
        \f[color,231,171,109]EP\f[color,default]\_l[30,-]%(ep0)/%(epmax0) %(ColorBar(3,20,ep0,epmax0)) \_l[150,-]\f[color,231,171,109]EP\f[color,default]\_l[180,-]%(ep1)/%(epmax1) %(ColorBar(3,170,ep1,epmax1))\n/ 
        \f[color,231,171,109]CP\f[color,default]\_l[30,-]%(cp0)/%(cpmax) %(ColorBar(9,20,cp0,cpmax)) \_l[150,-]\f[color,231,171,109]CP\f[color,default]\_l[180,-]%(cp1)/%(cpmax) %(ColorBar(9,170,cp1,cpmax))\n/

\_l[0,-]\__q[OnMonsterInfo]Class%(class)怪物\__q  \f[color,231,171,109]Level \f[color,default]%(mlv)  \_l[150,-]\f[color,231,171,109]HP \f[color,default] \_l[180,-]%(mhp)/%(mhpmax)   %(ColorBar(6,170,mhp,mhpmax))\n"
}


OnMonsterInfo
{
"\1%(怪物名字)属性攻击有效率：\n/
水：%(TOINT(100*水有效率))\n/
火：%(TOINT(100*火有效率))\n/
土：%(TOINT(100*土有效率))\n/
风：%(TOINT(100*风有效率))  \_l[170,-]\q[返回,backtoinfo]"

}


Select.backtoinfo
{

   if kikka==0 && towa==1
    {
    Onbattleselect0
    }

   elseif kikka==1 && towa==0
    {
    Onbattleselect1

    }

}




battleDbegin
{

battlemode=1
    if hp0==0
     {
      hp0=TOINT(0.1*hpmax0)
     }

   if hp1==0
     {
     hp1=TOINT(0.1*hpmax1)
     }

//battlenum+=1
mhpmax=TOINT(_argv[0])
mhp=mhpmax
IGN=1
ANG=1
STRADD=1
DEFADD=1
DEFMINUS=1
助威回合=-1
嚎叫回合=-1
示威回合=-1
黑暗诅咒回合=-1
噬血诅咒回合=-1
mstr=_argv[1]
mdef=_argv[2]
mats=_argv[3]
madf=_argv[4]
bata =_argv[5]
kikka=1
towa=0
magicready0=0
magicready1=0
mmagicready0=0
mmagicready1=0

if level==1
{
水有效率=1.3
火有效率=1.3
土有效率=1
风有效率=1
}

elseif level==1.1
{
水有效率=1.3
火有效率=1.3
土有效率=1
风有效率=1
}

elseif level==1.2
{
水有效率=1.3
火有效率=1.3
土有效率=1
风有效率=1
}

elseif level==1.3
{
水有效率=0.6
火有效率=1.4
土有效率=1
风有效率=1
}

elseif level==1.4
{
水有效率=1.5
火有效率=0.6
土有效率=1
风有效率=1
}

elseif level==1.5
{
水有效率=0.5
火有效率=1.5
土有效率=1
风有效率=1
}

elseif level==1.6
{
水有效率=1
火有效率=1
土有效率=1.2
风有效率=0.8
}

elseif level==1.7
{
水有效率=1.2
火有效率=1.2
土有效率=1.2
风有效率=1.2
}

else
{
水有效率=1
火有效率=1
土有效率=1
风有效率=1
}


/*hp0=hpmax0
hp1=hpmax1
ep0=epmax0
ep1=epmax1
*/

RpgGameVar
--
Onbattleselect




}



Onbattleselect
{
"\C\c"
--
if mhp <= 0
	{
		mhp = 0
	}
	--

if kikka==1 && towa==0 && hp0>0 && mhp>0
    {


    if hp1>0
        {
     kikka=0
      towa=1
        }
--
    Onbattleselect0
   
    

    }


elseif (kikka==0 && towa==1 ||hp0==0) && hp1>0 && mhp>0
    {
     战技回合判定
   --
 if hp0>0
        {
      kikka=1
      towa=0
        }
--
      Onbattleselect1

      
    }

elseif hp0==0 && hp1==0 && mhp>0
    {
    "战斗失败，回到主目录\x"
     battlefailednum+=1

     --
	OpenRpgGameMenu(5)
    }


        elseif hp0>0 && hp1>0 && mhp==0
	{
		kikkamoney += 50;
		"\t\0\s[5]战斗胜利了。\x"
		--
		战斗结束
	}
        elseif hp0>0 && hp==0 && mhp==0
	{
		kikkamoney += 50;
		"\t\0\s[5]战斗胜利了。\x"
		--
		战斗结束
	}

	elseif hp0==0 && hp1>0 && mhp==0
	{
		kikkamoney += 50;
		"\t\0\s[5]战斗胜利了。\x"
		--
		战斗结束
	}
	
--
battleinfo

}






Onbattleselect0
{
if magicready0==1
{
准备魔法0
}
else
{
"小缘应该\n/
\q[攻击,attack0]\n/
 \q[魔法,magic0]\n/
 \q[战技,spattack0]\n/
 \q[道具,item0]\n/
 \q[逃跑,escape]"
}
--
battleinfo

}


Onbattleselect1
{
if magicready1==1
{
准备魔法1
}
else
 {
if towashell==0
   {
        "当前兔子形态为使魔,兔子应该\n/
        \q[攻击,attack1]\n/
        \q[吸烟,smoke]\n/
        \q[魔法,magic1]\n/
        \q[战技,spattack1]\n/
        \q[道具,item1]\n/
        \q[逃跑,escape]"
    }

if towashell==1
   {
        "当前兔子形态为动物形态,兔子应该\n/
        \q[攻击,attack1]\n/
        \q[吸烟,smoke]\n/
        \q[兽技,beastsp]\n/
        \q[道具,item1]\n/
        \q[逃跑,escape]"
    }

if towashell==2
   {
        "当前兔子形态为半兽形态,兔子应该\n/
        \q[攻击,attack1]\n/
        \q[吸烟,smoke]\n/
        \q[魔法,magic1]\n/
        \q[战技,spattack1]\n/
        \q[兽技,beastsp]\n/
        \q[道具,item1]\n/
        \q[逃跑,escape]"
    }




}

--
battleinfo

}


Select.smoke
{

if towashell==0   
       {     
            if s==NULL
                   {   
                  s=1
               "兔子正在抽烟，尼古丁含量上升中。\x"
                   }
            elseif s==1
                   {   
                  s=2
               "兔子正在抽烟，尼古丁含量50%。\x"
                   }
            elseif s==2
                   {   
                 towashell=1
                  s=NULL
               "兔子正在抽烟，尼古丁含量100%。兔子转变形态\x"
                   }
       }

elseif towashell==1
       {     
            if s==NULL
                   {   
                  s=1
               "兔子正在抽烟，尼古丁含量上升中。\x"
                   }
            elseif s==1
                   {   
                  s=2
               "兔子正在抽烟，尼古丁含量50%。\x"
                   }
            elseif s==2
                   {   
                 towashell=2
                  s=NULL
               "兔子正在抽烟，尼古丁含量100%。兔子转变形态\x"
                   }
       }


elseif towashell==2
       {     
            if s==NULL
                   {   
                  s=1
               "兔子正在抽烟，尼古丁含量上升中。\x"
                   }
            elseif s==1
                   {   
                  s=2
               "兔子正在抽烟，尼古丁含量50%。\x"
                   }
            elseif s==2
                   {   
                 towashell=0
                  s=NULL
               "兔子正在抽烟，尼古丁含量100%。兔子转变形态\x"
                   }
       }
--
if battlemode==1
{
怪物反击
}
elseif battlemode==2
{
On休息
}

}








Select.attack0
{
      m=RAND(100)

   if m>=10
                 {


		伤害 = TOINT(ANG*3.38*str0-2.82*mdef)
		     
                  mhp-=伤害
                  "\0\s[32]小缘命中目标，%(怪物名字)损血%(伤害)\x"
                 
                  }

    else 
                 {
                
		伤害 = TOINT(1.5*ANG*(3.38*str0-2.82*mdef))
		     
                  mhp-=伤害
                  "\0\s[32]小缘对目标发动会心一击，%(怪物名字)损血%(伤害)\x"
                 
                 }

                --
                if 伤害>=TOINT(0.33*mhpmax)   
                 {
                 cp0+=3 
                 } 
                else
                 {
                 cp0+=10   
                 }

                 --
                      if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }


--
battleinfo
                    
}

Select.attack1
{
 m=RAND(100)

   if m>=10
                 {


		伤害 = TOINT(3.38*ANG*str1-2.82*mdef)
		     
                  mhp-=伤害
                  "\0\s[32]兔子命中目标，%(怪物名字)损血%(伤害)\x"
                 
                  }

    else 
                 {
                
		伤害 = TOINT(1.5*ANG*(3.38*str1-2.82*mdef))
		     
                  mhp-=伤害
                  "\0\s[32]兔子对目标发动会心一击，%(怪物名字)损血%(伤害)\x"
                 
 
                 }

                  --
                if 伤害>=TOINT(0.33*mhpmax)        
                 {
                 cp1+=3 
                 } 
                else
                 {
                 cp1+=10   
                 }



          --
       
                       怪物反击
	
--
battleinfo
}


Select.magic0
{
magicinfo
_txt="\![quicksession,true]\b[2]\n"
_txt+="\_l[0,-]魔法名称     \_l[80,-]属性    \_l[115,-]范围     \_l[145,-]消耗EP     \_l[185,-]效果\n" 
_魔法0 = (水系魔法,火系魔法,土系魔法,风系魔法)

foreach _魔法0; _i {
		         if lvl0>=TOINT(_i[5])
                           {
		_txt += "\_l[0,-]%(_i[2])     \_l[80,-]%(_i[3])   \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])  \_l[185,-]%(_i[7]) \_l[260,-]\q[使用,Onusemagic0,%(_i[0]),%(_i[2]),%(_i[3]),%(_i[4]),%(_i[5]),%(_i[6]),%(_i[7]),%(_i[8])]\n"
	                    }
                                        
                   }
_txt+="\n\n\n\n\n\q[返回,Onbattleselect0]"
_txt



--
battleinfo

}

Select.magic1
{
magicinfo
_txt="\![quicksession,true]\b[2]\n"

_txt+="\_l[0,-]魔法名称     \_l[80,-]属性    \_l[115,-]范围     \_l[145,-]消耗EP     \_l[185,-]效果\n" 
_魔法1 = (水系魔法,火系魔法,土系魔法,风系魔法)
foreach _魔法1; _i {
		     if lvl1>=TOINT(_i[5])
                        {
                       _txt += "\_l[0,-]%(_i[2])     \_l[80,-]%(_i[3])  \_l[115,-]%(_i[4])   \_l[145,-]%(_i[6])  \_l[185,-]%(_i[7]) \_l[260,-]\q[使用,Onusemagic1,%(_i[0]),%(_i[2]),%(_i[3]),%(_i[4]),%(_i[5]),%(_i[6]),%(_i[7]),%(_i[8])]\n"
	                }
                                        
                     }
_txt+="\n\n\n\n\n\q[返回,Onbattleselect1]"
_txt



--
battleinfo

}


Select.spattack0
{
_txt="\![quicksession,true]\b[2]\n"
_txt+="\_l[0,-]战技名称     \_l[90,-]属性    \_l[130,-]范围     \_l[170,-]消耗CP     \_l[210,-]效果\n" 

foreach 战技0; _i {
		    if lvl0>=TOINT(_i[4])
                       {
                         
                 _txt += "\_l[0,-]%(_i[1])     \_l[90,-]%(_i[2])   \_l[130,-]%(_i[3])   \_l[170,-]%(_i[5])  \_l[210,-]%(_i[6]) \_l[260,-]\q[使用,Onusesp0,%(_i[1]),%(_i[2]),%(_i[3]),%(_i[4]),%(_i[5]),%(_i[6]),%(_i[7])]\n"
                           
                        }
      
                   }
_txt+="\n\n\n\n\n\q[返回,Onbattleselect0]"
_txt



--
battleinfo

}



Select.spattack1
{
_txt="\![quicksession,true]\b[2]\n"
_txt+="\_l[0,-]战技名称     \_l[90,-]属性    \_l[130,-]范围     \_l[170,-]消耗CP     \_l[210,-]效果\n" 

foreach 战技1; _i { 
                   if lvl0>=TOINT(_i[4])
                       {
                        
     
                 _txt += "\_l[0,-]%(_i[1])     \_l[90,-]%(_i[2])   \_l[130,-]%(_i[3])   \_l[170,-]%(_i[5])  \_l[210,-]%(_i[6]) \_l[260,-]\q[使用,Onusesp1,%(_i[1]),%(_i[2]),%(_i[3]),%(_i[4]),%(_i[5]),%(_i[6]),%(_i[7])]\n"
                           
                      }
      
                                        
                   }
_txt+="\n\n\n\n\n\q[返回,Onbattleselect1]"
_txt

--
battleinfo

}


Onusesp0
{

战技名称=reference0
属性=reference1
效果数值=reference5
NUMS=reference6
CP消耗=TOINT(reference4)


    if cp0>=CP消耗
      {


      if 属性=="辅助"
            {
             cp0-=CP消耗
             STRADD=1.5
             助威回合=3
             "小缘发动了%(战技名称)，小缘STR上升50%，兔子STR上升50%。\x"
            }

      elseif 属性=="回复"
             {
          效果数值=TOINT(效果数值)
                    if hp1>0
                        {
                     if hp0+效果数值>=hpmax0 &&  hp1+效果数值>=hpmax1 && cp1>=CP消耗
                          {
                           hp0=hpmax0
                           hp1=hpmax1
                           cp0-=CP消耗
                          "小缘发动了%(战技名称)，小缘HP回复%(hpmax0-hp0)，兔子HP回复%(hpmax1-hp1)\x"
                             

                          }

                     elseif hp0+效果数值<hpmax0 && hp1+效果数值<hpmax1 && cp1>=CP消耗
                         {
                          hp0+=效果数值
                          hp1+=效果数值
                          cp0-=CP消耗
                      "小缘发动了%(战技名称)，小缘HP回复%(效果数值)，兔子HP回复%(效果数值)\x"
         
                        }

                    elseif hp0+效果数值>=hpmax0 &&  hp1+效果数值<hpmax1 && cp1>=CP消耗
                        {     
                        hp0=hpmax0
                        hp1+=效果数值
                        cp0-=CP消耗
                      "小缘发动了%(战技名称)，小缘HP回复%(hpmax0-hp0)，兔子HP回复%(效果数值)\x"
       
                        }


                     elseif hp0+效果数值<hpmax0 &&  hp1+效果数值>=hpmax1 && cp1>=CP消耗
                        {
       
                      "小缘发动了%(战技名称)，小缘HP回复%(效果数值)，兔子HP回复%(hpmax1-hp1)\x"
                       hp0+=效果数值
                       hp1=hpmax1
                       cp0-=CP消耗
                         }
                  }

               else 
                 {
                 if hp0+效果数值>=hpmax0 && cp1>=CP消耗
                          {
                           hp0=hpmax0
                           cp0-=CP消耗
                          "小缘发动了%(战技名称)，HP回复%(hpmax0-hp0)\x"
                             

                          }

                     elseif hp0+效果数值<hpmax0 && cp1>=CP消耗
                         {
                          hp0+=效果数值
                          cp0-=CP消耗
                      "小缘发动了%(战技名称)，HP回复%(效果数值)\x"
         
                        }
                 }

              }


         elseif 属性=="攻击"
              {
                 if 效果数值=="驱动解除"
                 {
                 
                  战技伤害=TOINT(ANG*NUMS*(3.38*str0-2.82*mdef))
                   

                  if 战技伤害<0
                               {
                               战技伤害=0
                               }
                  mhp-=战技伤害
                  cp0-=CP消耗
  
                  if mmagicready0==1||mmagicready1==1
                 {
                 mmagicready0=0
                 mmagicready1=0

            "小缘对%(怪物名字)使用了%(战技名称)，%(怪物名字)损血%(战技伤害),%(怪物名字)驱动的魔法解除\x"

                 }
                   else
                  {
                  "小缘对%(怪物名字)使用了%(战技名称)，%(怪物名字)损血%(战技伤害)\x"
                  }
                       --
                  if 战技伤害>=(1/3)*mhpmax    
                             {
                               cp0+=3 
                             } 
                  else
                             {
                             cp0+=10   
                             }


                 }
 




                   else
                   {

                   战技伤害=TOINT(ANG*NUMS*(3.38*str0-2.82*mdef+效果数值))
                      

                  if 战技伤害<0
                               {
                               战技伤害=0
                               }
                  mhp-=战技伤害
                  cp0-=CP消耗
                  "小缘对%(怪物名字)使用了%(战技名称)，%(怪物名字)损血%(战技伤害)\x"

                       --
                  if 战技伤害>=(1/3)*mhpmax    
                             {
                               cp0+=3 
                             } 
                  else
                             {
                             cp0+=10   
                             }
                  }
              }

         
          elseif 属性=="攻击S"
                  {

                   if cp0>=100 && cp0<200
                        {
                              
                    战技伤害=TOINT(ANG*NUMS*(3.38*str0-2.82*mdef+效果数值))
                              
                             
       
                              
                  if 战技伤害<0
                               {
                               战技伤害=0
                               }
                  mhp-=战技伤害
                  cp0-=CP消耗
                  "小缘对%(怪物名字)使用了%(战技名称)，%(怪物名字)损血%(战技伤害)\x"

                       --
                  if 战技伤害>=(1/3)*mhpmax    
                             {
                               cp0+=3 
                             } 
                  else
                             {
                             cp0+=10   
                             }
                           
 
                       } 
            

                    elseif cp0==200
                       {
                                
                  if 战技名称=="奥义·天下无双"  
                              {
                    战技伤害=TOINT(ANG*3*(3.38*str0-2.82*mdef+1.5*效果数值))
                              }
                              else
                              {
                   战技伤害=TOINT(ANG*2*(3.38*str0-2.82*mdef+1.5*效果数值))
                              }
                  if 战技伤害<0
                               {
                               战技伤害=0
                               }
                  mhp-=战技伤害
                  cp0-=200
                  "小缘对%(怪物名字)使用了%(战技名称)，%(怪物名字)损血%(战技伤害)\x"

                       --
                  if 战技伤害>=(1/3)*mhpmax    
                             {
                               cp0+=3 
                             } 
                  else
                             {
                             cp0+=10   
                             }
                           
 
                       }    
                     

                  }
 

         --
RpgGameVar

         --
       if hp1>0
                        {
                       Onbattleselect
                        }
                      else
                        {
                        怪物反击
                        }
       }

   else
        {"CP不足，不能发动战技\x"
          
                --
             Onbattleselect0
             

        }
                     
                   
}



Onusesp1
{

     

战技名称=reference0
属性=reference1
效果数值=reference5
NUMS=reference6
CP消耗=TOINT(reference4)


     if cp1>=CP消耗
        {

                 if 属性=="攻击"
                   {
                    
                        战技伤害=TOINT(ANG*NUMS*(3.38*str1-2.82*mdef+效果数值))
                            

                  if 战技伤害<0
                               {
                               战技伤害=0
                               }
                  mhp-=战技伤害
                  cp1-=CP消耗
                  "兔子对%(怪物名字)使用了%(战技名称)，%(怪物名字)损血%(战技伤害)\x"

                       --
                  if 战技伤害>=(1/3)*mhpmax    
                             {
                               cp1+=3 
                             } 
                  else
                             {
                             cp1+=10   
                             }
                    


                  }

         
          elseif 属性=="攻击S"
                  {

                   if cp1>=100 && cp1<200
                        {
                               
                           战技伤害=TOINT(ANG*NUMS*(3.38*str1-2.82*mdef+效果数值))
                            
                   
                  if 战技伤害<0
                               {
                               战技伤害=0
                               }
                  mhp-=战技伤害
                  cp1-=CP消耗
                  "兔子对%(怪物名字)使用了%(战技名称)，%(怪物名字)损血%(战技伤害)\x"

                       --
                  if 战技伤害>=(1/3)*mhpmax    
                             {
                               cp1+=3 
                             } 
                  else
                             {
                             cp1+=10   
                             }
                           
 
                       } 
            

                    elseif cp1==200
                       {
                                
                         if 战技名称=="奥义·量子风暴"
                                   {
                           战技伤害=TOINT(ANG*3*(3.38*str1-2.82*mdef+1.5*效果数值))
                                   }
                               else
                                  {
                          战技伤害=TOINT(ANG*2*(3.38*str1-2.82*mdef+1.5*效果数值))
                                  }
                   
                  if 战技伤害<0
                               {
                               战技伤害=0
                               }
                  mhp-=战技伤害
                  cp1-=200
                  "兔子对%(怪物名字)使用了%(战技名称)，%(怪物名字)损血%(战技伤害)\x"

                       --
                  if 战技伤害>=(1/3)*mhpmax    
                             {
                               cp1+=3 
                             } 
                  else
                             {
                             cp1+=10   
                             }
                           
 
                       }    
                     

                  }
--
 RpgGameVar

         --
       怪物反击
       }

         

    else
        {"CP不足，不能发动战技\x"
          
                --
             Onbattleselect1
             

        }
                     
                   
}


Select.beastsp
{
"\b[2]\![set,choicetimeout,0]\![quicksession,true]\__q[Onusebeastsp,0,25]猫爪三连击：攻击三次，消耗CP25\__q\n/
\__q[Onusebeastsp,1,30]嚎叫：我方物理防御提升50%，有效三回合，消耗CP30\__q\n/
\__q[Onusebeastsp,2,20]示威：下一次攻击时，无视对方防御力，消耗CP20\__q\n/
\__q[Onusebeastsp,3,30]黑暗诅咒：对方物理防御减50%，有效三回合，消耗CP30\__q\n/
\__q[Onusebeastsp,4,20]噬血诅咒：攻击时给予对方的伤害翻倍，有效一回合，消耗CP20\__q\n/
\__q[Onusebeastsp,5,100]牺牲：用自身HP的50%换取敌方HP的50%，消耗CP100\__q\n/
\__q[Onusebeastsp,6,50]偷取：偷取对方20%的HP。消耗CP50\n/
\n\n\n\n\q[返回,Onbattleselect1]\n/
"
}

Onusebeastsp
{
兽技ID=reference0
消耗SP=TOINT(reference1)
if cp1>=消耗SP
   {
      if 兽技ID==0
         {
           
           兽技伤害=TOINT(ANG*3*(3.38*str1-2.82*mdef))
            if 兽技伤害<0
              {
              兽技伤害=0
              }
            mhp-=兽技伤害
            "兔子对%(怪物名字)使用了猫爪三连击，%(怪物名字)损血%(兽技伤害)\x"
         }
      elseif 兽技ID==1
         {
         DEFADD=1.5
         嚎叫回合=3
          "兔子使用了嚎叫，DEF提升50%。\x"
         }
      elseif 兽技ID==2
         {
         IGN=0
         示威回合=1
         "兔子使用了示威，%(怪物名字)DEF被无视了。\x"
         }
      elseif 兽技ID==3
         {
         DEFMINUS=0.5
         黑暗诅咒回合=3
          "兔子使用了黑暗诅咒，%(怪物名字)DEF降低50%。\x"
         }
      elseif 兽技ID==4
         {
         ANG=2
         噬血诅咒回合=1
         "兔子使用了噬血诅咒\x"
         }
      elseif 兽技ID==5
         {
         hp1=TOINT(0.5*hp1)
         mhp=TOINT(0.5*mhp)
          "兔子使用了牺牲，兔子HP减少%(TOINT(0.5*hp1)),%(怪物名字)HP减少%(TOINT(0.5*mhp))\x"
         }
      elseif 兽技ID==6
         {
          if hp1+0.2*mhp>=hp1max
             {
               "兔子使用了偷取，兔子HP增加%(TOINT(hpmax1-hp1)),%(怪物名字)HP减少%(TOINT(0.2*mhp))\x"
                  --
               hp1=hpmax1
             }
          else 
             { 
             hp1+=0.2*mhp
          "兔子使用了偷取，兔子HP增加%(TOINT(0.2*mhp)),%(怪物名字)HP减少%(TOINT(0.2*mhp))\x"
             }
             --
         mhp=TOINT(0.8*mhp)
         
         
         }
--
cp1-=消耗SP

--
怪物反击

    }

  else
    {
"SP不足\x"
    --
  Onbattleselect1
    }



       --
RpgGameVar

--

if class=="D"
{
mdef=mdefD
}

elseif class=="C"
{
mdef=mdefC
}

elseif class=="B"
{
mdef=mdefB
}

elseif class=="A"
{
mdef=mdefA
}




}

战技回合判定
{
     

   

      if 助威回合>0
         {
        助威回合--
         }
      elseif 助威回合==0
       {
       助威回合=-1
        --
       STRADD=1
       "小缘使用的助威技能失效了\x"
       }
    
--
      if 嚎叫回合>0
         {
        嚎叫回合--
         }
      elseif 嚎叫回合==0
       {
       嚎叫回合=-1
        --
       DEFADD=1
       "兔子使用的嚎叫技能失效了\x"
       }
    
  --
 
      if 示威回合>0
         {
        示威回合--
         }

      elseif 示威回合==0
       {
       示威回合=-1
       --
       IGN=1
       "兔子使用的示威技能失效了\x"
       }
    
--
  
      if 黑暗诅咒回合>0
         {
        黑暗诅咒回合--
         }
      elseif 黑暗诅咒回合==0
       {
       黑暗诅咒回合=-1
        --
       DEFMINUS=1
      "兔子使用的黑暗诅咒技能失效了\x"
       }

--

      if 噬血诅咒回合>0
         {
        噬血诅咒回合--
         }
         elseif 噬血诅咒回合==0
       {
       噬血诅咒回合=-1
        --
       ANG=1
       "兔子使用的噬血诅咒技能失效了\x"
       }
    


       --
RpgGameVar
}

Select.item0
{
信息参数
_txt="\![quicksession,true]\b[2]\n"

_txt+="\_l[0,-]名称    \_l[80,-]效果   \_l[140,-]买入价格 \_l[195,-]已有数量  \n     "
foreach itemA; _i {
                       if _i[3]>0 
                             {
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[140,-]%(_i[4])  \_l[195,-]%(_i[3]) \_l[260,-] \q[使用,Onuseitemselect0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[5])]\n"
                             }

   
		 }

foreach itemB; _i {
                        if _i[3]>0 
                             {
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[140,-]%(_i[4])  \_l[195,-]%(_i[3]) \_l[260,-] \q[使用,Onuseitemselect0,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[5])]\n"
                             }

 
		 }
_txt+="\n\n\n\n\q[返回,Onbattleselect0]"
_txt
--
battleinfo

}

Select.item1
{
信息参数
_txt="\![quicksession,true]\b[2]\n"

_txt+="\_l[0,-]名称    \_l[80,-]效果   \_l[140,-]买入价格 \_l[195,-]已有数量  \n     "
foreach itemA; _i {
                        if _i[3]>0 
                            {
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[140,-]%(_i[4])  \_l[195,-]%(_i[3]) \_l[260,-] \q[使用,Onuseitemselect1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[5])]\n"
		            }
                  }
foreach itemB; _i {
                         if _i[3]>0 
                            {
      _txt += "\_l[0,-]%(_i[2]) \_l[80,-]%(_i[5]) \_l[140,-]%(_i[4])  \_l[195,-]%(_i[3]) \_l[260,-] \q[使用,Onuseitemselect1,%(_i[0]),%(_i[1]),%(_i[2]),%(_i[5])]\n"
                            }

		 }


_txt+="\n\n\n\n\q[返回,Onbattleselect1]"
_txt
--
battleinfo

}

Select.escape
{
                escapenum+=1
                e=RAND(100)
                if (e < 50) 
		{
			"\0\s[5]逃跑成功。\x"
                          --
                           OpenRpgGameMenu(5)
		}
		elseif (e >= 50)
		{
			"\0\s[9]逃跑失败。\x"
			--
			怪物反击
		}

              



}


怪物反击
{

       if mhp>0
       {

             if mmagicready0==1
            {
             怪物准备魔法0
            }
            if mmagicready1==1
            {
            怪物准备魔法1
            }


          else 
             {

		_temp = RAND(100)
		if (_temp <= 50 && hp0>0) || hp1==0
		{
			怪物反击0
		}
		elseif (_temp > 50 && hp1>0) || hp0==0
		{
			怪物反击1
		}
             }
	}
	else
	{
		kikkamoney += 50;
		"\0\s[5]战斗胜利了\x"
		--
		战斗结束
	}

--
battleinfo

}

怪物准备魔法0
       {
mmagicready0=0
       hp0-=反击魔法伤害
 "\0\s[33]%(怪物名字)对小缘发动了%(反击魔法名称)，小缘损血%(反击魔法伤害)\x"
 --

		Onbattleselect
                      }

怪物准备魔法1
       {
mmagicready1=0
       hp1-=反击魔法伤害
 "\0\s[33]%(怪物名字)对兔子发动了%(反击魔法名称)，兔子损血%(反击魔法伤害)\x"
--
		Onbattleselect
                      }

怪物反击0
{
_mmagic=IARRAY

  m=RAND(100)
 
   if m>=40
            {
                
		怪伤害0 = TOINT(3.38*mstr-2.82*def0)
                if 怪伤害0<0
                    {
                     怪伤害0=0
                    }
                hp0 -= 怪伤害0
		"\0\s[33]小缘被攻击了，损血%(怪伤害0)\x"

             }

    elseif m>=10 && m<40 && mlv>=15
        {
                             
                   
          if level==1 || level==1.1 || level==1.2

             {
                c=RAND(9)
               if c>=5
               {
               mmagic=NULL
                  foreach 土系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                  if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                         mmagicready0=1
                          反击魔法伤害=魔法伤害

                   "%(怪物名字)正在准备魔法\x"
                      
                }

                else
               {
               mmagic=NULL
                  foreach 风系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                      if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                   mmagicready0=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
                }

             }

          elseif level==1.3 || level==1.5
            {
              mmagic=NULL
                  foreach 水系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) && _i[3]=="攻击"
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                     if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                   mmagicready0=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"

            }


           elseif level==1.4
            {
            mmagic=NULL
                  foreach 火系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5])
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                        if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                   mmagicready0=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
            }

           elseif level==1.6
          
           {
            mmagic=NULL
                  foreach 风系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5])
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                      if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                    MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                  mmagicready0=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"

            }

           else

             {
                c=RAND(9)

                if c>=8 && c<=9
                {
               mmagic=NULL
                  foreach 水系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) && _i[3]=="回复"
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                  x=ARRAYSIZE(_mmagic)-1
                      if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=TOINT(_mmagic[x][7])
                    if _mmagic[x][7]=="战斗不能解除" || _mmagic[x][7]=="HP全回复"
                     {
                        怪伤害0 = TOINT(3.38*mstr-2.82*def0)
                           if 怪伤害0<0
                    {
                     怪伤害0=0
                    }
                hp0 -= 怪伤害0
		"\0\s[33]小缘被攻击了，损血%(怪伤害0)\x"
                     }
                      
                
                   elseif mhp + 反击效果数值>=mhpmax
                   {
                 mhp=mhpmax
                  
                 "%(怪物名字)发动了%(mmagic[x][2])，HP回复%(mhpmax-mhp)\x"
                   }
                   elseif mhp + 反击效果数值<mhpmax
                   {
                   mhp+=反击效果数值
                   "%(怪物名字)发动了%(mmagic[x][2])，HP回复%(反击效果数值)\x"
                   }
                     
                 }

                elseif c>=6 && c<=7
               {
               mmagic=NULL
                  foreach 水系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) && _i[3]=="攻击"
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                   mmagicready0=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
                }
 

              elseif c>=4 && c<=5
              {
               mmagic=NULL
                  foreach 火系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                    MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                   mmagicready0=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
              }
            
              elseif c>=2 && c<=3
              {
               mmagic=NULL
                  foreach 土系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                    mmagicready0=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
              }
            

                 elseif c>=0 && c<=1
              {
               mmagic=NULL
                  foreach 风系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                   mmagicready0=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
              }
            




             }
            

         }

       




         elseif m>=0 && m<10 && mlv>=15
                {
		怪伤害0 = TOINT(1.5*(3.38*mstr-2.82*def0))
                 if 怪伤害0<0
                    {
                     怪伤害0=0
                    }
                hp0 -= 怪伤害0
		"\0\s[33]%(怪物名字)对小缘发动会心一击，小缘损血%(怪伤害0)\x"
             
                } 


		--
                 if hp0<0
                  {
                   hp0=0
                   losehpnum+=1
                   "\0\s[35]小缘失去战斗能力\x"
                  }
                          
                
              --

		Onbattleselect
                   
--
battleinfo
}


怪物反击1
{
_mmagic=IARRAY
              m=RAND(100)
           if m>=40
            {

		怪伤害1 = TOINT(3.38*mstr-2.82*def1)
                   if 怪伤害1<0
                    {
                     怪伤害1=0
                    }
                hp1 -= 怪伤害1
		"兔子被攻击了，损血%(怪伤害1)\x"
            }


            elseif m>=10 && m<40 && mlv>=15
        {
                             
                   
          if level==1 || level==1.1 || level==1.2

             {
                c=RAND(9)
               if c>=5
               {
               mmagic=NULL
                  foreach 土系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                       if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                    MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                    mmagicready1=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
                }

                else
               {
               mmagic=NULL
                  foreach 风系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                    if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                    MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                    mmagicready1=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
                }

             }

          elseif level==1.3 || level==1.5
            {
              mmagic=NULL
                  foreach 水系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) && _i[3]=="攻击"
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                  if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                   mmagicready1=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
            }


           elseif level==1.4
            {
            mmagic=NULL
                  foreach 火系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5])
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                        if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                    mmagicready1=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"

            }

           elseif level==1.6
          
           {
            mmagic=NULL
                  foreach 风系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5])
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                    if x>0
                    {
                    x=RAND(x)+1
                    }
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                   MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                   mmagicready1=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"

            }

           else

             {
                c=RAND(9)

                if c>=8 && c<=9
                {
               mmagic=NULL
                  foreach 水系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) && _i[3]=="回复"
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                  x=ARRAYSIZE(_mmagic)-1
                     反击效果数值=TOINT(_mmagic[x][7])
                     反击魔法名称=_mmagic[x][2]
                    if _mmagic[x][7]=="战斗不能解除" || _mmagic[x][7]=="HP全回复"
                     {

               
		怪伤害1 = TOINT(3.38*mstr-2.82*def1)
                   if 怪伤害1<0
                    {
                     怪伤害1=0
                    }
                hp1 -= 怪伤害1
		"兔子被攻击了，损血%(怪伤害1)\x"

                     }

                   elseif mhp + 反击效果数值>=mhpmax
                   {
                 mhp=mhpmax
                  
                 "%(怪物名字)发动了%(mmagic[x][2])，HP回复%(mhpmax-mhp)\x"
                   }
                   elseif mhp + 反击效果数值<mhpmax
                   {
                   mhp+=反击效果数值
                   "%(怪物名字)发动了%(mmagic[x][2])，HP回复%(反击效果数值)\x"
                   }

                 }

                elseif c>=6 && c<=7
               {
               mmagic=NULL
                  foreach 水系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) && _i[3]=="攻击"
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                    mmagicready1=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
                }
 

              elseif c>=4 && c<=5
              {
               mmagic=NULL
                  foreach 火系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                    mmagicready1=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
              }
            
              elseif c>=2 && c<=3
              {
               mmagic=NULL
                  foreach 土系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                     MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                 mmagicready1=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
              }
            

                 elseif c>=0 && c<=1
              {
               mmagic=NULL
                  foreach 风系魔法; _i 
                   {
		         if mlv>=TOINT(_i[5]) 
                           {

                           _mmagic,=_i
	                    }
                                        
                   }
                
                  x=ARRAYSIZE(_mmagic)-1
                     反击效果数值=_mmagic[x][7]
                     反击魔法名称=_mmagic[x][2]
                      MNUMS=_mmagic[x][8]
                     魔法伤害=TOINT(MNUMS*(4.10*mats-2.80*adf0+反击效果数值))
                     if 魔法伤害<0
                               {
                               魔法伤害=0
                               }
                    mmagicready1=1
                   反击魔法伤害=魔法伤害
                   "%(怪物名字)正在准备魔法\x"
              }
            




             }
            

         }

       



         elseif m>=0 && m<10 && mlv>=15
                {
		怪伤害1 = TOINT(1.5*(3.38*mstr-2.82*def1))
                 if 怪伤害1<0
                    {
                     怪伤害1=0
                    }
                 hp1 -= 怪伤害1
		"%(怪物名字)对兔子发动会心一击，兔子损血%(怪伤害1)\x"
             
                } 

		--
		  if hp1<0
                  {
                   hp1=0
                  losehpnum+=1
                   "兔子失去战斗能力\x"
                  }


                --
		Onbattleselect
                 
                   

--
battleinfo

}

战斗结束
{       

battlemode=2
      if mhp <= 0
	{
		mhp = 0
	}


      if hp0==0
       {
      hp0=TOINT(0.1*hpmax0)
       }

      if hp1==0
      {
     hp1=TOINT(0.1*hpmax1)
      }
	--
        intimacy+=1
        victorynum+=1
        mnum+=1
        money+=TOINT(2*level*mlv*bata)
        exp0+=TOINT(2*level*mlv*bata)
        exptotal0+=TOINT(2*level*mlv*bata)
        exp1+=TOINT(2*level*mlv*bata)
        exptotal1+=TOINT(2*level*mlv*bata)
     
        if level==8 && class=="D"
        {
        w=RAND(50)
        }
        elseif level==8 && class=="C"
        {
        w=RAND(40)
        }
        elseif level==8 && class=="B"
        {
        w=RAND(30)
        }
        elseif level==8 && class=="A"
        {
        w=RAND(20)
        }
        else
        {
        w=RAND(100)
        }
         --

          if w>10 && w<=20    
          {

             i=RAND(10)
            if i>=5
             {
              if mlv<80
                   {
                     i=RAND(mlv/16)

           itemAnum[i]+=1
           "获得%(itemA[i][2])\n"
                   }
                else
                   {
              i=RAND(5)
           "获得%(itemA[i][2])\n"
                   }
             } 
             
            elseif i<5
             {
                if mlv<80
                   {
                  i=RAND(mlv/20)
           itemBnum[i]+=1
           "获得%(itemB[i][2])\n"
                   }
                else
                   {
              i=RAND(4)
           "获得%(itemB[i][2])\n"
                   }
             } 
         }

         elseif w>6 && w<=10
         {
               if mlv<130
                {
                    i=RAND(2+mlv/10)
           bootsBnum[i]+=1
           "获得%(bootsB[i][2])\n"
                }
                else
                {
                   i=RAND(14)
             bootsBnum[i]+=1
           "获得%(bootsB[i][2])\n"
                }
       
          }  


         elseif w>2 && w<=6
          {
            
            if mlv<130
                {

               i=RAND(2+mlv/5)

           weaponBnum[i]+=1
           "获得%(weaponB[i][2])\n"
                }

             else
                 {
               i=RAND(29)
                 weaponBnum[i]+=1
           "获得%(weaponB[i][2])\n"

                 }

          }       


         elseif w<=2
         {
              
            if mlv<126
                {
                   i=RAND(2+mlv/7)
           armorBnum[i]+=1
           "获得%(armorB[i][2])\n"
                }
             else
                 {
               i=RAND(19)
                 armorBnum[i]+=1
           "获得%(armorB[i][2])\n"

                 }

          }   

       --
         "小缘获得经验%(TOINT(2*level*mlv*bata))，兔子获得经验%(TOINT(2*level*mlv*bata))\n"

       --
          "获得金钱%(TOINT(2*level*mlv*bata))\n"  
      

       
      --
        nextexp0 = expmax0 - exp0
        nextexp1 = expmax1 - exp1

	if nextexp0<=0
	{
                nextexp_0=nextexp0
                lvl0 += 1
		exp0 = -nextexp_0
                RpgGameVar
		hp0=hpmax0
                ep0=epmax0
		
		_txt="\0\s[5]小缘升级了！\n\w9目前等级：%(lvl0)\n"
                --

                foreach 魔法0; _i
                   {
                        if lvl0==TOINT(_i[5])
                               {
		             
                         
                 _txt+="\0\s[5]小缘学得新魔法%(_i[2])\n"
                                                 
                               }
                     }
                  --
                  foreach 战技0; _i
                   {
                        if lvl0==TOINT(_i[4])
                               {
		             
                         
                 _txt+="\0\s[5]小缘学得新战技%(_i[1])\n"
                                                 
                               }
                     }

   


              _txt
	}

       
	else
	{
		""
	}

         --

	if nextexp1<=0
	{
                nextexp_1=nextexp1
                lvl1 += 1
		exp1 = -nextexp_1
                RpgGameVar
		hp1=hpmax1
                ep1=epmax1
		
		_txt="\0\s[5]兔子升级了！\n\w9目前等级：%(lvl1)\n"

                --
                 foreach 魔法1; _i
                   {
                        if lvl1==TOINT(_i[5])
                               {
		             
                         
                _txt+="兔子学得新魔法%(_i[2])\n"
                                                 
                               }
                     }

                     --
                  foreach 战技1; _i
                   {
                        if lvl1==TOINT(_i[4])
                               {
		             
                         
                 _txt+="\0\s[5]兔子学得新战技%(_i[1])\n"
                                                 
                               }
                     }


                  _txt


	}
	else
	{
		""
	}

      
       --
   
        if mnum<10
          {
	"\t\0\q[继续逛,Onbattle]\n/
         \q[休息一下,On休息]\n/
         \q[回去吧,back]"
          }


        elseif mnum>=10
          {
           award=1
         
         "任务完成,回去领取奖励？\n/
           \q[回去吧,back]\n/  
           \q[继续逛,Onbattle]"           
          
           }
   

      --
      
       battleinfo
    
}

Select.back
{

OpenRpgGameMenu(5)


}


Onesc
{
"\0\s[40]确定退出rpg1.04吗？\n/
\q[是,yseesc]\n/
\q[否,noesc]"
}

Select.yseesc
{
"\0\s[40]那么，再见啦！\w9"

--
OpenMenu(1)

}

Select.noesc
{
OpenRpgGameMenu(5)


}

On休息
{
battlemode=2
"休息一下回复体力吧，接下来要做什么呢？\n/
\q[吸烟,smoke]\n/
\q[使用道具,On道具列表]\n/
\q[使用魔法,On魔法列表]\n/
\q[继续逛,Onbattle]"


}



ClearRpgGameVar
{

         
        ERASEVAR("weaponA");
	ERASEVAR("weaponB");
	ERASEVAR("article");
	ERASEVAR("armorA");
	ERASEVAR("armorB");
	ERASEVAR("bootsA");
        ERASEVAR("bootsB");
        ERASEVAR("itemA");
        ERASEVAR("itemB");
        ERASEVAR("boxnum");
        ERASEVAR("水系魔法");
        ERASEVAR("火系魔法");
        ERASEVAR("土系魔法");
        ERASEVAR("风系魔法");
        ERASEVAR("weapon");
        ERASEVAR("armor");
        ERASEVAR("boots");
        ERASEVAR("战技0");
        ERASEVAR("战技1");
        ERASEVAR("魔法0");
        ERASEVAR("魔法1");
        ERASEVAR("spattack0");
        ERASEVAR("spattack1");
        ERASEVAR("magicA");
        

}
